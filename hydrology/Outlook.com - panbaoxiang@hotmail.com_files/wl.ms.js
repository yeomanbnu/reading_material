(function(){if(!window.WL&&!window.OneDrive){window.OneDrive={};OneDrive.Constants={WebViewLink:Q,DownloadLink:Wb};OneDrive.open=function(c){var b=h(c),a=new x(b,Wd);try{a.initialize();a.validateOpenParameters();a.executeOpenOperation()}catch(d){a.processError(d,N)}};OneDrive.save=function(c){var b=h(c),a=new x(b,Xd);try{a.initialize();a.validateSaveParameters();a.executeSaveOperation()}catch(d){a.processErrorCallback(d,N)}};OneDrive.createOpenButton=function(d){var c=h(d),a=new x(c,Ub);try{a.initialize();a.validateOpenParameters();a.validateButtonParameters();var b=a.createButtonElement();g(b,Z,function(){a.executeOpenOperation()});return b}catch(e){a.processError(e,N);return null}};OneDrive.createSaveButton=function(d){var c=h(d),a=new x(c,kd);try{a.initialize();a.validateSaveParameters();a.validateButtonParameters();var b=a.createButtonElement();g(b,Z,function(){a.executeSaveOperation()});return b}catch(e){a.processErrorCallback(e,N);return null}};function x(d,e){var b=this,c=d[Jd];b._internalApp=WL.UnitTests&&typeof c===E?c:a;b._options=d;b._method=e}x.createButtonElement=function(a,e,d){var b={};b[f]=e;b[D]=d;var c=Tb(b,true);a.innerHTML=c.innerHTML;a.id=c.buttonId;a.title=c.buttonTitle;Xb(b,a);return a};x.prototype={initialize:function(){var a=this;if(a._internalApp._status!==vb){var b=oe();if(!b)throw new Error(od.replace(i,a._method));a._internalApp.appInit({client_id:b,interface_method:a._method});df("Picker SDK initialized with client_id: "+b,ONEDRIVE_PREFIX)}},executeOpenOperation:function(){var b=this,d=b._internalApp,a=b._options,g=b._method,c={mode:G,resourceType:P,select:a[qc]?pb:y,linkType:a[ub],interface_method:g},e=a[S],f=a[T];d.fileDialog(c).then(function(h){var f=a[ub],g=[],d=h.data||[];for(var c=0;c<d.length;c++){var b=d[c];g[c]={fileName:b.name,link:f===Q?b.link:b.source,linkType:f,size:b.size,thumbnails:b.images&&b.images.map(function(a){return a.source})||[]}}e(g)},function(a){a.error===wc?H(f):b.processError(a,Zb)})},executeSaveOperation:function(){var b=this,c=b._internalApp,a=b._options,d=b._method,j=a[yc],f=a[kc],h=a[S],g=a[lc],i=a[T],e={mode:F,resourceType:O,select:y,interface_method:d};c.fileDialog(e).then(function(e){var a={path:e.data[0].id,element:j,overwrite:sd,file_name:f,interface_method:d};c.upload(a).then(function(){H(h)},function(a){b.processErrorCallback(a,pd)},function(a){H(g,a.progressPercentage)})},function(a){a.error===wc?H(i):b.processError(a,Zb)})},validateOpenParameters:function(){l(this._options,[{name:ub,type:b,optional:true,defaultValue:Q,allowedValues:[Wb,Q]},{name:qc,type:Mb,optional:true,defaultValue:false},{name:S,type:c,optional:false},{name:T,type:c,optional:true}],this._method)},validateSaveParameters:function(){l(this._options,[{name:kc,type:b,optional:true},{name:yc,type:b,optional:false},{name:S,type:c,optional:true},{name:lc,type:c,optional:true},{name:T,type:c,optional:true},{name:sc,type:c,optional:true}],this._method)},validateButtonParameters:function(){l(this._options,[{name:tc,type:b,optional:true,defaultValue:sb,allowedValues:[sb,td]}],this._method)},createButtonElement:function(){var a=document.createElement("button"),c=this._method===Ub?q:qb,b=this._options[tc]===sb?wb:U;return x.createButtonElement(a,c,b)},processError:function(c,b){var a=Lb(le,this._method,b,JSON.stringify(c));o(a,ONEDRIVE_PREFIX);return a},processErrorCallback:function(b,a){H(this._options[sc],this.processError(b,a))}};var rh="download",d="interface_method",id="WL.Internal.jsonp.",ge=2000,Mc="body",fg="json_body",C="callback",bb="code",Qf="Content-Type",Eg="element",Ic="error",Xf="error_description",qg="file_name",gg="file_input",Yf="file_output",xf="request_headers",uf="response_headers",rg="Location",Cc="logging",X="message",Cb="method",hg="overwrite",sd="rename",Gb="path",vf="percentageComplete",Pg="Prefer",xe="pretty",Ff="respond-async",Qg="result",Rg="status",Sd="http_status",Rd="return_ssl_resources",Rf="stream_input",Fg="tracing",Sg="error",Af=202,Gf=201,sg=200,rf=500,tg="success",Kd="suppress_redirects",sf="suppress_response_codes",I="x_http_live_library",Jc=0,vb=1,m="access_token",wh="appstate",Pc="authentication_token",Kb="client_id",yh="display",Hh="code",Qb="error",Qc="error_description",Yc="expires",Rc="expires_in",Dh="locale",Zg="redirect_uri",Ng="response_type",Sc="request_ts",Me="resource_id",cd="scope",zh="session",Og="secure_cookie",Ze="state",Eh="status",hh=[m,Pc,cd,Rc,Yc],Qe="connected",bh="notConnected",sh="unchecked",Ch="unknown",Ue="expiring",Bh="expired",ch="live-sdk-upload",Hg="live-sdk-download",af="appId",lh="channelUrl",xh="wl_auth",mh="wl_upload",uh="page",nh="touch",th="none",Gc="none",Tg="auth.login",Ig="auth.logout",gc="auth.sessionChange",If="auth.statusChange",Ye="wl.log",wc="access_denied",Fd="connection_failed",wg="invalid_cookie",Ud="invalid_request",Hc="request_canceled",V="request_failed",Ge="timed_out",yg="unknown_user",ig="user_canceled",Cf="METHOD: Failed to get the required user permission to perform this operation.",zd="The request could not be completed due to browser issues.",ec="The request could not be completed due to browser limitations.",Ec="METHOD: The operation has been canceled.",yf="The 'wl_auth' cookie is not valid.",tf="The 'wl_auth' cookie has been modified incorrectly. Ensure that the redirect URI only modifies sub-keys for values received from the OAuth endpoint.",lf="The 'wl_auth' cookie has multiple values. Ensure that the redirect URI specifies a cookie domain and path when setting cookies.",Ld="METHOD: The input property 'PARAM' does not reference a valid DOM element.",be="METHOD: An exception was received for EVENT. Detail: MESSAGE",Md="METHOD: The WL object must be initialized with WL.init() prior to invoking this method.",jc="A connection to the server could not be established.",qf="The user could not be identified.",Mf="METHOD: Failed to get upload_location of the resource.",Hf="The pending login request has been canceled.",nf="Logging out the user is not supported in current session because the user is logged in with a Microsoft account on this computer. To logout, the user may quit the app or log out from the computer.",fc="METHOD: The input value for parameter/property 'PARAM' is not valid.",Ad="METHOD: The input parameter/property 'PARAM' must be included.",nd="METHOD: The type of the provided value for the input parameter/property 'PARAM' is not valid.",nb="METHOD: There is a pending METHOD request, the current call will be ignored.",jf=nb.replace(/METHOD/g,Ae),fd=nb.replace(/METHOD/g,J),kf=nb.replace(/METHOD/g,ve),of="METHOD: The input property 'redirect_uri' is required if the value of the 'response_type' property is 'code'.",hf="WL.init: The redirect_uri value should be the same as the value of 'Redirect Domain' of your registered app. It must begin with 'http://' or 'https://'.",mf="METHOD: The api call is not supported on this platform.",ff="WL.init: The response_type value 'code' is not supported on this platform.",xg="METHOD: The input property 'redirect_uri' must use https: to match the scheme of the current page.",Ef="The auth request is timed out.",Nf="The popup is closed without receiving consent.",Bb=0,xd=1,hc=2,ne=3,Kc="GET",ze="POST",eh="PUT",Ag="DELETE",Ug="COPY",Vg="MOVE",J="WL.fileDialog",Oc="WL.api",kg="WL.download",Lc="WL.init",Ae="WL.login",db="WL.ui",ve="WL.upload",Jf=30000,i="METHOD",M="PARAM",s="onSuccess",t="onError",z="onProgress",oh="redirect_type",Bg="auth",Zf="upload",Cg="code",mg="token",fb="https:",Wc="http:",Se="wl.signin",Je="wl.skydrive",Yd="wl.skydrive_update",Lg=/\s|,/,Mb="boolean",dd="dom",c="function",Xc="number",E="object",ab="properties",b="string",pe="string_or_array",cb="undefined",Pe="name",Db="element",jh="brand",qh="type",Uf="sign_in_text",Of="sign_out_text",D="theme",ng="onloggedin",cg="onloggedout",Eb="onerror",Dg="messenger",Xg="hotmail",Mg="skydrive",Yg="windows",bg="windowslive",ph="none",bd="signin",Wf=bd,dg="login",Pf="connect",Vf="custom",wb="blue",U="white",gh="id",Le="auth_server",u="apiservice_uri",v="skydrive_uri",j="sdk_root",bf="wl_trace",e={subscribe:function(a,b){lb("Subscribe "+a);var c=e.getHandlers(a);c.push(b)},unsubscribe:function(c,f){lb("Unsubscribe "+c);var b=e.getHandlers(c),d=[];if(f!=null){var g=false;for(var a=0;a<b.length;a++)if(g||b[a]!=f)d.push(b[a]);else g=true}e._eHandlers[c]=d},getHandlers:function(b){if(!e._eHandlers)e._eHandlers={};var a=e._eHandlers[b];if(a==null)e._eHandlers[b]=a=[];return a},notify:function(c,d){lb("Notify "+c);var b=e.getHandlers(c);for(var a=0;a<b.length;a++)b[a](d)}},a={_status:Jc,_statusRequests:[],_rpsAuth:false};a.appInit=function(b){var f=b[d]||Lc;if(a._status==vb){var g=a._session.getNormalStatus();return oc(f,true,b.callback,g)}var c=WL[j];if(c){if(c.charAt(c.length-1)!=="/")c+="/";a[j]=c}var e=b[Cc];if(e===false)a._logEnabled=e;if(a.testInit)a.testInit(b);a._status=vb;return Cd(b)};a.onloadInit=function(){Fe();Ie()};function Fb(b){if(a._status===Jc)throw new Error(Md.replace(i,b))}function Xe(){return WL.Internal.tApp||a}a.api=function(a){Fb(Oc);var c=a[Mc];if(c){a=h(Ib(c),a);delete a[Mc]}var b=a[Cb];a[Cb]=(b!=null?Pb(b):Kc).toUpperCase();return (new Zc(a)).execute()};var de=function(){var b=a.api.lastId,c;b=b===undefined?1:b+1;c="WLAPI_REQ_"+b+"_"+(new Date).getTime();a.api.lastId=b;return c},Zc=function(b){var c=this;c._properties=b;c._completed=false;c._id=de();b[xe]=false;b[Rd]=a._isHttps;b[I]=a[I];var d=b[Gb];c._url=Oe(d)?d:ye()+(d[0]==="/"?d.substring(1):d);c._promise=new p(Oc,null,null)};Zc.prototype={execute:function(){ue(this);return this._promise},onCompleted:function(a){if(this._completed)return;this._completed=true;L(this._properties.callback,a,true);if(a[Qb])this._promise[t](a);else this._promise[s](a)}};function Bc(f,c,b,e,d){b=b?Pb(b):"";var a=b!==""?Be(b):null;if(a===null){a={};if(Math.floor(c/100)!==2)a[Ic]=re(c,e)}if(d)d.forEach(function(b){a[b.name]=b.value});a[Sd]=c;f.onCompleted(a)}function re(c,b){var a={};a[bb]=V;a[X]=b||jc;return a}function ee(){var c=null;if(!a._rpsAuth){var b=Xe()._session.getStatus();if(b.status===Ue||b.status===Qe)c=b.session[m]}return c}function Ib(i){var c={};for(var b in i){var a=i[b],j=typeof a;if(a instanceof Array)for(var d=0;d<a.length;d++){var f=a[d],l=typeof f;if(j==E&&!(a instanceof Date)){var h=Ib(f);for(var e in h)c[b+"."+d+"."+e]=h[e]}else c[b+"."+d]=f}else if(j==E&&!(a instanceof Date)){var k=Ib(a);for(var g in k)c[b+"."+g]=k[g]}else c[b]=a}return c}function Nd(c,b){o(b.message);var a=c[Eb];if(a)hb(function(){error=tb(db,db,b),a(error)})}function Nc(){return a[j]}function Re(){return Nc()+"images"}var ag=new RegExp("^\\w+\\.\\w+:\\w+\\|\\w+\\|\\w+:([\\d\\w]+\\!\\d+)$");function Pb(a){return a.replace(/^\s+|\s+$/g,"")}function dc(a,b){return a&&b?a.toLowerCase()===b.toLowerCase():a===b}function zc(a){return a==null||a===""}function Lb(){var a=arguments,c=a[0];function b(b){return a[parseInt(b.replace(/[\{\}]/g,""))+1]||""}return c.replace(/\{\d+\}/g,b)}function Ob(b){var a={c:0,s:-1};return b.replace(/[^\w .,-]/g,function(d,b,c){if(me(c,b,a))return ["&#",a.c,";"].join("");return ""})}function me(f,b,a){var d=a.s===b;if(!d){b=b||0;var c=f.charCodeAt(b),g,e;a.s=-1;if(c<55296||c>57343)a.c=c;else if(c<=56319){g=c;e=f.charCodeAt(b+1);a.c=(g-55296)*1024+(e-56320)+65536;a.s=b+1}else{a.c=-1;d=true}}return !d}function h(b,d){var c=d||{};if(b!=null)for(var a in b)c[a]=b[a];return c}function qe(e,d,b){var c=h(e,d);for(var a=0;a<b.length;a++)delete c[b[a]];return c}function ad(a){return Array.prototype.slice.call(a)}function w(b,a){return function(){if(typeof a===c)return a.apply(b,arguments)}}function ed(a,g,d){d=d||"[WL]";a=d+a;var c=window;if(c.debugLogger)c.debugLogger.push(a);var b=c.console;if(b&&b.log)switch(g){case "warning":b.warn(a);break;case "error":b.error(a);break;default:b.log(a)}var f=c.opera;if(f)f.postError(a);var e=c.debugService;if(e)e.trace(a)}function Oe(a){return a.indexOf("https://")===0||a.indexOf("http://")===0}function lb(b){if(a._traceEnabled)ed(b)}function mb(b,d,c){if(a._logEnabled||a._traceEnabled)ed(b,d,c);e.notify(Ye,b)}if(window.WL&&WL.Internal){WL.Internal.trace=lb;WL.Internal.log=mb}function df(b,a){mb(b,"text",a)}function o(b,a){mb(b,"error",a)}function vc(b){var a=document.createElement(b);a.style.position="absolute";a.style.top="-1000px";a.style.width="300px";a.style.height="300px";a.style.visibility="hidden";return a}function Td(){var a=null;while(a==null){a="wl_"+Math.floor(Math.random()*1024*1024);if(K(a)!=null)a=null}return a}function K(a){return document.getElementById(a)}function ef(a){h(Rb(a),this)}ef.prototype={toString:function(){var a=this,b=(a.scheme!=""?a.scheme+"//":"")+a.host+(a.port!=""?":"+a.port:"")+a.path;return b},resolve:function(){var a=this;if(a.scheme==""){var b=window.location.port,c=window.location.host;a.scheme=window.location.protocol;a.host=c.split(":")[0];a.port=b!=null?b:"";if(a.path.charAt(0)!="/")a.path=he(a.host,window.location.href,a.path)}}};function Rb(c){var e=c.indexOf(fb)==0?fb:c.indexOf(Wc)==0?Wc:"",h="",i="",f;if(e!="")var b=c.substring(e.length+2),a=b.indexOf("/"),g=a>0?b.substring(0,a):b,d=g.split(":"),h=d[0],i=d.length>1?d[1]:"",f=a>0?b.substring(a):"";else f=c;return {scheme:e,host:h,port:i,path:f}}function Ne(a){return Rb(a.toLowerCase()).host}function he(e,b,h){var d=function(a,c){charIdx=b.indexOf(c);a=charIdx>0?a.substring(0,charIdx):a;return a};b=d(d(b,"?"),"#");var f=b.indexOf(e),a=b.substring(f+e.length),g=a.indexOf("/"),c=a.lastIndexOf("/");a=c>=0?a.substring(g,c):a;return a+"/"+h}function H(a,b){if(typeof a==c)b?a(b):a()}function L(a,b,e,d){if(typeof a==c){if(d)b[Ze]=d;if(e)a(b);else hb(function(){a(b)})}}function Be(a){return JSON.parse(a)}function cf(b,c){var d=b.length;for(var a=0;a<d;a++)c(b[a])}function B(d,c){var a={},b={};a[bb]=d,a[X]=c;b[Ic]=a;return b}function tb(a,b,c){return B(V,be.replace("METHOD",a).replace("EVENT",b).replace("MESSAGE",c.message))}function Qd(b){var a=b.split(".");return a[0]+"."+a[1]}function hb(a,b){window.wlUnitTests?wlUnitTests.delayInvoke(a):window.setTimeout(a,b||1)}function Fe(){var b=He(navigator.userAgent,document.documentMode),c=a[I];a._browser=b;a[I]=c.replace("DEVICE",b.device)}function He(a,e){a=a.toLowerCase();var c="other",b={"firefox":/firefox/.test(a),"firefox1.5":/firefox\/1\.5/.test(a),"firefox2":/firefox\/2/.test(a),"firefox3":/firefox\/3/.test(a),"firefox4":/firefox\/4/.test(a),"ie":(/msie/.test(a)||/trident/.test(a))&&!/opera/.test(a),"ie6":false,"ie7":false,"ie8":false,"ie9":false,"ie10":false,"ie11":false,"opera":/opera/.test(a),"webkit":/webkit/.test(a),"chrome":/chrome/.test(a),"mobile":/mobile/.test(a)||/phone/.test(a)};if(b["ie"]){var d=0;if(e)d=e;else if(/msie 7/.test(a))d=7;d=Math.min(11,Math.max(d,6));c="ie"+d;b[c]=true}else if(b.firefox)c="firefox";else if(b.chrome)c="chrome";else if(b.webkit)c="webkit";else if(b.opera)c="opera";if(b.mobile)c+="mobile";b.device=c;return b}function pc(e,c){var f=c!=null?c:{};if(e!=null){var d=e.split("&");for(var b=0;b<d.length;b++){var a=d[b].split("=");if(a.length==2)f[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}}return f}function ie(b){var a="";if(b!=null)for(var c in b){var d=a.length==0?"":"&",e=b[c];a+=d+encodeURIComponent(c)+"="+encodeURIComponent(je(e))}return a}function je(a){if(a instanceof Date){var b=function(a,b){switch(b){case 2:return a<10?"0"+a:a;case 3:return (a<10?"00":a<100?"0":"")+a}};return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1,2)+"-"+b(a.getUTCDate(),2)+"T"+b(a.getUTCHours(),2)+":"+b(a.getUTCMinutes(),2)+":"+b(a.getUTCSeconds(),2)+"."+b(a.getUTCMilliseconds(),3)+"Z"}return ""+a}function we(b){var d=b.indexOf("?")+1,c=b.indexOf("#")+1,a={};if(d>0){var e=c>d?c-1:b.length;a=pc(b.substring(d,e),a)}if(c>0)a=pc(b.substring(c),a);return a}function uc(a,b){return a+(a.indexOf("?")<0?"?":"&")+ie(b)}var cc={name:C,type:c,optional:true},zf={name:C,type:c,optional:false};function Ke(a,c,d){if(a instanceof Array)for(var b=0;b<a.length;b++)Tc(a[b],c[b],d);else Tc(a,c,d)}function Tc(c,a,b){Fc(c,a,b);if(a.type===ab)l(c,a.properties,b)}function Fc(g,f,d,h){var e=f.name,a=typeof g,j=f.type;if(a===cb||g==null)if(f.optional){h&&h();return}else throw ic(e,d);switch(j){case b:if(a!=b)throw A(e,d);if(!f.optional&&Pb(g)==="")throw ic(e,d);break;case ab:if(a!=E)throw A(e,d);break;case c:if(a!=c)throw A(a,d);break;case dd:if(a==b){if(K(g)==null)throw new Error(Ld.replace(i,d).replace(M,e))}else if(a!=E)throw A(e,d);break;case pe:if(a!=b&&!(g instanceof Array))throw A(a,d);break;default:if(a!=j)throw A(e,d)}if(f.allowedValues!=null)fe(g,f.allowedValues,f.caseSensitive,e,d)}function l(g,d,f){var b=g||{};for(var c=0;c<d.length;c++){var a=d[c],e=b[a.name]||b[a.altName];Fc(e,a,f,function(){if(typeof a.defaultValue!=cb)b[a.name]=a.defaultValue})}}function fe(d,a,e,f,h){var g=typeof a[0]===b;for(var c=0;c<a.length;c++)if(g&&!e){if(d.toLowerCase()===a[c].toLowerCase())return}else if(d===a[c])return;throw Ed(f,h)}function A(a,b){return new Error(nd.replace(i,b).replace(M,a))}function ic(a,b){return new Error(Ad.replace(i,b).replace(M,a))}function Ed(c,d,a){var b=fc.replace(i,d).replace(M,c);if(typeof a!==cb)b+=" "+a;return new Error(b)}function Ab(k,j){var g=ad(k),a=null,b=null;for(var f=0;f<g.length;f++){var e=g[f],i=typeof e;if(i===E&&a===null)a=h(e);else if(i===c&&b===null)b=e}a=a||{};if(b)a.callback=b;a[d]=j;return a}function Id(a,b){var c=tb(a,a,b);o(b.message);return oc(a,false,null,c)}var p=function(b,c,a){this._name=b;this._op=c;this._uplinkPromise=a;this._isCompleted=false;this._listeners=[]};p.prototype={then:function(d,e,c){var b=new p(null,null,this),a={};a[s]=d;a[t]=e;a[z]=c;a.chainedPromise=b;this._listeners.push(a);return b},cancel:function(){if(this._isCompleted)return;if(this._uplinkPromise&&!this._uplinkPromise._isCompleted)this._uplinkPromise.cancel();else{var a=this._op?this._op.cancel:null;if(typeof a===c)this._op.cancel();else this.onError(B(Hc,Ec.replace("METHOD",this._getName())))}},_getName:function(){if(this._name)return this._name;if(this._op&&typeof this._op._getName===c)return this._op._getName();if(this._uplinkPromise)return this._uplinkPromise._getName();return ""},_onEvent:function(b,a){if(this._isCompleted)return;this._isCompleted=a!==z;this._notify(b,a)},_notify:function(b,a){var c=this;cf(this._listeners,function(g){var h=g[a],d=g.chainedPromise,f=a!==z;if(h)try{var e=h.apply(g,b);if(f&&e&&e.then){d._op=e;e.then(function(a){d[s](a)},function(a){d[t](a)},function(a){d[z](a)})}}catch(i){if(f)d.onError(tb(c._getName(),a,i))}else if(f)d[a].apply(d,b)})}};p.prototype[s]=function(){this._onEvent(arguments,s)};p.prototype[t]=function(){this._onEvent(arguments,t)};p.prototype[z]=function(){this._onEvent(arguments,z)};function oc(f,e,b,g){var a=new p(f,null,null),d=e?s:t;if(typeof b===c)a.then(function(a){b(a)});hb(function(){a[d](g)});return a}var hh=[m,Pc,cd,Rc,Yc,Sc,Qb,Qc],ah="refresh_type",eg="app",og="ms",pg="response_method",Kf="url",wf="cookie",W="onanalytics",ug="login",Bf="loginstatus",Dd="file_dialog",jg="auth.response",Dc="client-id",pf="OneDriveSaveButton",Gh="file",Z="click",Nb="onedrive-js",mc="2px",bc="0px",xc="4px",od="METHOD: Failed to initialize due to missing 'client-id'.",ud="Loading OneDrive picker is timed out.",f="mode",q="open",qb="save",G="read",F="readwrite",rb="linkType",Yb="resourceType",P="file",O="folder",r="select",y="single",pb="multi",rd="permission",jd="onetime",R="lightbox",md="grey",Sb="transparent",ob="white",Vb="loading_timeout",ac="onselected",T="cancel",sc="error",yc="file",kc="fileName",Jd="internal_app",ub=rb,Wb="downloadLink",Q="webViewLink",lc="progress",qc="multiSelect",S="success",tc="theme",sb="blue",td="white",gf=i+": This upload method is not implemented.",le="{0}: Operation: '{1}' Error message: {2}",Df="API call",Zb="invoke picker",N="unhandled exception",pd="upload",Wd="OneDrive.open",Xd="OneDrive.save",Ub="OneDrive.createOpenButton",kd="OneDrive.createSaveButton",Vd="auth",vd="rps",qd="oauth",wd="v",gd="1",hd="2",Gd="domain",Bd="livesdk",ce="mkt";FILEDIALOG_PARAM_PICKER_SCRIPT="pickerscript";FILEDIALOG_CHCMD_ONCOMPLETE="onPickerComplete",FILEDIALOG_CHCMD_UPDATETOKEN="updateToken";var We=27;UI_SKYDRIVEPICKER="skydrivepicker",ONEDRIVE_PREFIX="[OneDrive]";window.WL={};WL.Internal={};WL.init=function(d){try{var c=h(d);Ke(c,{name:ab,type:ab,optional:false,properties:[{name:Kb,altName:af,type:b,optional:false},{name:Cc,type:Mb,optional:true}]},Lc);a.appInit(c)}catch(e){o(e.message)}};WL.ui=function(){try{var c=Ab(arguments);l(c,[{name:Pe,type:b,allowedValues:[UI_SKYDRIVEPICKER],optional:false},cc],db);a.ui(c)}catch(f){Nd(c,f)}};WL.fileDialog=function(){try{var b=J,c=Ab(arguments,b);nc(c,b);return a.fileDialog(c)}catch(f){return Id(b,f)}};function nc(e,d){l(e,[{name:f,type:b,allowedValues:[q,qb,G,F],optional:false},{name:Yb,type:b,allowedValues:[P,O],optional:true},{name:r,type:b,allowedValues:[y,pb],optional:true},{name:R,type:b,allowedValues:[md,Sb,ob],optional:true},{name:Vb,type:Xc,optional:true},{name:rd,type:b,allowedValues:[jd],optional:true},cc],d);if(d!==J)l(e,[{name:D,allowedValues:[wb,U],type:b,optional:true},{name:ac,type:c,optional:false},{name:Eb,type:c,optional:true}],d);if(!Hb.isSupported()||!window.JSON||a._browser.mobile)throw new Error(ec)}function Cd(b){a._rpsAuth=true;a._appId=b[Kb]}function Ie(){a._logEnabled=true;a._urlParams=we(window.location.href);a._traceEnabled=a._urlParams[bf];var b=window.wlAsyncInit;if(b&&typeof b===c)b.call()}function ue(a){if(Pd(a))return;if(sendAPIRequestViaXHR(a))return;if(Od(a))return;var b={};b[bb]=V;b[X]=ec;a.onCompleted(b)}function ye(){return a[u]}a.jsonp={};WL.Internal.jsonp=a.jsonp;function Pd(c){var h=document.getElementsByTagName("HEAD")[0],b=document.createElement("SCRIPT"),d=qe(c._properties,d,[C,Gb]),e=c._id,f=ee();if(f!=null)d[m]=f;d[C]=id+e;d[Kd]="true";var g=uc(c._url,d);if(g.length>ge)return false;c.scriptTag=b;a.jsonp[e]=function(a){xb(e,b);c.onCompleted(a)};ke(b,c);b.setAttribute("async","async");b.type="text/javascript";b.src=g;h.appendChild(b);window.setTimeout(function(){if(c._completed)return;xb(e,b)},30000);return true}function ke(b,c){if(a._browser.ie&&b.attachEvent)b.attachEvent("onreadystatechange",function(a){Jb(a,c)});else{b.readyState="complete";b.addEventListener("load",function(a){Jb(a,c)},false);b.addEventListener("error",function(a){Jb(a,c)},false)}}function Jb(d,c){if(c._completed)return;var b=d.srcElement||d.currentTarget;if(!b.readyState)b=d.currentTarget;if(b.readyState!="complete"&&b.readyState!="loaded")return;var f=c._id;failure=d.type=="error"||a.jsonp[f]!=null;if(failure){xb(f,c.scriptTag);var e={};e[bb]=Fd;e[X]=jc;c.onCompleted({error:e})}}function xb(b,c){delete a.jsonp[b];document.getElementsByTagName("HEAD")[0].removeChild(c)}function Od(b){Ve();if(a._browser.flashVersion<9)return false;a.xdrFlash.send(b);return true}a.xdrFlash={_id:"",_status:Bb,_flashObject:null,_requests:{},_pending:[],init:function(){if(this._status!=Bb)return;this._status=xd;var c=vc("div");c.id="wl_xdr_container";document.body.appendChild(c);this._id=Td();var b=Hd,d=a[j]+"XDR.swf";b=b.replace(/{url}/g,d);b=b.replace(/{id}/g,this._id);b=b.replace(/{variables}/g,"domain="+document.domain);c.innerHTML=b},onReady:function(b){if(b){if(a._browser.firefox)this._flashObject=document.embeds[this._id];else this._flashObject=K(this._id);this._status=hc}else this._status=ne;while(this._pending.length>0)this.send(this._pending.shift())},onRequestCompleted:function(b,e,c,f){var d=a.xdrFlash._requests[b];delete a.xdrFlash._requests[b];Bc(d,e,Ce(c),f)},send:function(a){if(this._status<hc){this._pending.push(a);if(this._status==Bb)zb(w(this,this.init));return}if(this._flashObject!=null){this._requests[a._id]=a;var b=prepareXDRRequest(a);this.invoke("send",[a._id,b.url,b.method,b.body])}else Bc(a,0,null,zd)},invoke:function(d,a){a=a||[];var c=window.__flash__argumentsToXML(a,0),e='<invoke name="'+d+'" returntype="javascript">'+c+"</invoke>",b=this._flashObject.CallFunction(e);if(b==null)return null;return eval(b)}};WL.Internal.xdrFlash=a.xdrFlash;function Ce(a){return a?a.replace(/\r/g," ").replace(/\n/g," "):a}var Hd="<object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' codebase='https://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0' width='300' height='300' id='{id}' name='{id}' type='application/x-shockwave-flash' data='{url}'>"+"<param name='movie' value='{url}'></param>"+"<param name='allowScriptAccess' value='always'></param>"+"<param name='FlashVars' value='{variables}'></param>"+"<embed play='true' menu='false' swLiveConnect='true' allowScriptAccess='always' type='application/x-shockwave-flash' FlashVars='{variables}' src='{url}' width='300' height='300' name='{id}'></embed>"+"</object>",yb=null;(function(){a.fileDialog=function(b){Fb(b[d]);if(a._pendingPickerOp!=null)throw new Error(fd);return (new yb(b)).execute()};var j=0,b=1,h=2,c=3;yb=function(c){var b=this;b._props=c;b._startTs=(new Date).getTime();c[R]=c[R]||ob;c[r]=c[r]||y;b._state=j;b._authDelegate=w(b,b._onAuthResp);a._pendingPickerOp=b};yb.prototype={execute:function(){var a=this,b=new p(a._props[d],a,null);a._promise=b;a._process();return b},cancel:function(a){var b=this;if(b._state===c)return;if(!a)a=B(Hc,Ec.replace(i,b._props[d]));b._onComplete(a)},_process:function(){var a=this;switch(a._state){case j:a._validateAuth();break;case b:a._initPicker();break;case h:a._complete()}},_changeState:function(d,b){var a=this;if(a._state!==c&&a._state!==d){a._state=d;if(b)a._result=b;a._process()}},_onComplete:function(a){this._changeState(h,a)},_validateAuth:function(){var c=this,g=false;if(a._rpsAuth)c._changeState(b);else{var e="";switch(c._props[f]){case q:e=Je;break;case qb:e=Yd;break;case G:case F:e=c._buildExternalScope();g=true;break;default:var k=fc.replace(i,J).replace(M,f);c._onComplete(B(Ud,k));return}var j=c._props[d],h=650;if(g)a.login({scope:e,external_consent:true}).then(function(a){c._onExternalConsentComplete(a)},function(a){c._onComplete(a)});else{e+=" "+Se;a.ensurePermission(e,h,j,c._authDelegate)}}},_buildExternalScope:function(){var b=this,a="onedrive_onetime.access:";switch(b._props[f]){case G:a+=G;break;case F:a+=F}switch(b._props[Yb]){case P:a+="file|";break;case O:a+="folder|";break;default:a+="file|"}a+=b._props[r]===y?y:pb;if(b._props[rb])a+="|"+b._props[rb];return a},_onAuthResp:function(c){var a=this;if(c.error){if(!a._channel)a._onComplete(c)}else{var d=c.session[m];a._props[m]=d;if(a._channel)a._channel.send(FILEDIALOG_CHCMD_UPDATETOKEN,d);else a._changeState(b)}},_initPicker:function(){var b=this,c=b._props;o(c);b._channel=a.channel.registerOuterChannel(Dd,Rb(c.url).host,c.frame.contentWindow,c.url,w(b,b._onMessage));e.subscribe(gc,b._authDelegate);var d=function(a){if(a.keyCode===We)b.cancel()};c.keydownHandler=d;g(window,"keydown",d);b._initTimeout()},_initTimeout:function(){var a=this;timeoutSeconds=a._props[Vb];if(timeoutSeconds&&timeoutSeconds>0)a._timeout=window.setTimeout(w(a,a._onTimeout),timeoutSeconds*1000)},_onTimeout:function(){var a=this,b=a._channel._connected;if(!b)a.cancel(B(Ge,ud));a._clearTimeout()},_clearTimeout:function(){var a=this;if(a._timeout){window.clearTimeout(a._timeout);a._timeout=undefined}},_complete:function(){var b=this,e=b._result,f=e.error?t:s;b._state=c;b._cleanup();b._normalizeResp();if(b._props[d]===J)L(b._props[C],e,true);else if(e.data)L(b._props[ac],e,true);else L(b._props[Eb],e,true);b._promise[f](e);if(!a._rpsAuth)hb(function(){b._report()})},_report:function(){var g=this._props,b=this._result,l=((new Date).getTime()-this._startTs)/1000,j="none",c=0,e=0;if(b.data){if(b.data.folders!=null)c=b.data.folders.length;if(b.data.files!=null)e=b.data.files.length}j=c>0&&e>0?"both":c>0?O:e>0?P:"none";var k=c+e,i={client:UI_SKYDRIVEPICKER,api:g[d],mode:g[f],select:g[r],result:b.error?b.error.code:"success",duration:l,object_selected:j,selected_count:k},h=a[W];a.api({path:"web_analytics",method:ze,body:i});if(h)h(i)},_onExternalConsentComplete:function(c){var b=this;if(c.error){b._onComplete(c);return}var e=c[Me];if(e==null){b._onComplete(B(V,"Did not get expected resource id."));return}a.api({path:e+"/files",method:Kc,interface_method:b._props[d]}).then(function(a){b._onComplete(a)},function(a){b._onComplete(a)})},_onMessage:function(a,b){mb(a);switch(a){case FILEDIALOG_CHCMD_ONCOMPLETE:this._onComplete(b)}},_normalizeResp:function(){var g=this,j=g._props[f]===q,b=g._result.data,e=g._result.error,h=function(c){var b=c.upload_location;if(b)c.upload_location=b.replace("WL_APISERVICE_URL",a[u])};if(b){if(b.folders)for(var c=0;c<b.folders.length;c++)h(b.folders[c]);if(b.files)for(var c=0;c<b.files.length;c++)h(b.files[c])}if(e&&e.message)e.message=e.message.replace(i,g._props[d])},_cleanup:function(){var c=this,b=c._props,g=c._channel,f=b.resizeHandler,d=b.keydownHandler;c._clearTimeout();e.unsubscribe(gc,c._authDelegate);if(b.lightBox){b.frame.style.display=Gc;b.lightBox.style.display=Gc;document.body.removeChild(b.frame);document.body.removeChild(b.lightBox);delete b.lightBox;delete b.frame}if(g){g.dispose();delete c._channel}if(f)n(window,"resize",f);if(d)n(window,"keydown",d);delete a._pendingPickerOp}};function o(c){var h=c[f]===q,e=h?800:500,d=h?600:450,i=c[R],p=i===Sb,m=p?0:60,r=i===ob?"white":"rgb(0,0,0)",n=m/100,j=k(e,d),o=l(c),b=document.createElement("div");b.style.top="0px";b.style.left="0px";b.style.position="fixed";b.style.width="100%";b.style.height="100%";b.style.display="block";b.style.backgroundColor=r;b.style.opacity=n;b.style.MozOpacity=n;b.style.filter="alpha(opacity="+m+")";b.style.zIndex="2600000";var a=document.createElement("iframe");a.id="picker"+(new Date).getTime();a.style.top=j.top;a.style.left=j.left;a.style.position="fixed";a.style.width=e+"px";a.style.height=d+"px";a.style.display="block";a.style.zIndex="2600001";a.style.borderWidth="1px";a.style.borderColor="gray";a.style.maxHeight="100%";a.style.maxWidth="100%";a.src=o;a.setAttribute("sutra","picker");document.body.appendChild(a);document.body.appendChild(b);c.resizeHandler=function(){var b=k(e,d);a.style.top=b.top;a.style.left=b.left};g(window,"resize",c.resizeHandler);c.lightBox=b;c.frame=a;c.url=o}function l(d){var e=d[f]===q,g=e?hd:gd,b={},c=Nc()+a[FILEDIALOG_PARAM_PICKER_SCRIPT];if(c.charAt(0)==="/")c=fb+c;b[wd]=g;b[Vd]=a._rpsAuth?vd:qd;b[Gd]=window.location.hostname.toLowerCase();b[Bd]=c;b[Kb]=a._appId;b[Sc]=(new Date).getTime();b[ce]=a._locale;if(!a._rpsAuth)b[m]=d[m];if(e)b[r]=d[r];return uc(a[v],b)}function k(f,e){var b,c;if(a._browser.ie){var d=document.documentElement;b=(d.clientWidth-f)/2;c=(d.clientHeight-e)/2}else{b=(window.innerWidth-f)/2;c=(window.innerHeight-e)/2}b=b<10?10:b;c=c<10?10:c;return {left:b+"px",top:c+"px"}}})();a.ui=function(a){Fb(db);switch(a.name){case bd:new SignInControl(a);break;case UI_SKYDRIVEPICKER:new rc(a)}};var rc=function(b){nc(b);var a=this;a._props=b;zb(w(a,a.init))};rc.prototype={init:function(){var a=this;if(a._inited===true)return;a._inited=true;try{var c=a._props,e=c[Db],f=c[C];c[d]="WL.ui-"+UI_SKYDRIVEPICKER;a.validate();c[D]=c[D]||U;e=typeof e===b?K(c[Db]):e;a._element=e;var g=ld(c);Te(e,g);yd(e,w(a,a.onClick),w(a,a.onRender));a.onRender(false,false);L(f,c,false)}catch(h){o(h.message)}},validate:function(){var a=this._props;l(a,[{name:Db,type:dd,optional:false}],a[d])},onClick:function(){try{return a.fileDialog(this._props)}catch(b){o(b.message)}return false},onRender:function(){Xb(this._props,this._element.childNodes[0])}};function Xb(k,e){var h=k[D]===U,j=a._locale,f=j.indexOf("ar")>-1||j.indexOf("he")>-1,l=f?"RTL":"LTR",n=e.childNodes[0],m=e.childNodes[1],d="#094AB2",i="#ffffff",b=e.style,g=n.style,c=m.style;b.direction=l;b.backgroundColor=h?i:d;b.border="solid 1px";b.borderColor=d;b.height="20px";b.paddingLeft=xc;b.paddingRight=xc;b.textAlign="center";b.cursor="pointer";g.verticalAlign="middle";g.height="16px";c.fontFamily="'Segoe UI', 'Segoe UI Web Regular', 'Helvetica Neue', 'BBAlpha Sans', 'S60 Sans', Arial, 'sans-serif'";c.fontSize="12px";c.fontWeight="bold";c.color=h?d:i;c.textAlign="center";c.verticalAlign="middle";c.marginLeft=f?bc:mc;c.marginRight=f?mc:bc}function ld(b){var a=Tb(b,false);return "<button id='"+Ob(a.buttonId)+"' title='"+Ob(a.buttonTitle)+"'>"+a.innerHTML+"</button>"}function Tb(b,c){var n=b[f],m=b[D],a=n===q,e=a?kb.skyDriveOpenPickerButtonText:kb.skyDriveSavePickerButtonText,j=m===wb?"SkyDriveIcon_white.png":"SkyDriveIcon_blue.png",i="<img alt='' src='"+Re()+"/SkyDrivePicker/"+j+"'>",h="<span>"+Ob(e)+"</span>",d=a?kb.skyDriveOpenPickerButtonTooltip:kb.skyDriveSavePickerButtonTooltip,k=c?"onedriveopenpickerbutton":"skydriveopenpickerbutton",l=c?"onedrivesavepickerbutton":"skydrivesavepickerbutton",g=a?k:l;return {innerHTML:i+h,buttonTitle:d,buttonId:g}}function yd(c,m,l){var a=c.childNodes[0];if(m){var f=function(b){if(c.childNodes.length==0){n(a,Z,f);return}m(b)};g(a,Z,f)}if(l){var d=false,e=false,h=function(a){e=true;b(a)},i=function(a){e=false;b(a)},j=function(a){d=true;b(a)},k=function(a){d=false;b(a)},b=function(){if(c.childNodes.length==0){n(a,"mouseenter",h);n(a,"mouseleave",i);n(document,"mousedown",j);n(document,"mouseup",k);return}l(d,e)};g(a,"mouseenter",h);g(a,"mouseleave",i);g(document,"mousedown",j);g(document,"mouseup",k)}}function Ve(){if(a._browser.flash!==undefined)return;var b=0;try{if(a._browser.ie){var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),f=k.GetVariable("$version"),i=f.split(" "),g=i[1],d=g.split(",");b=d[0]}else if(navigator.plugins&&navigator.plugins.length>0)if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var j=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",e=navigator.plugins["Shockwave Flash"+j].description,h=e.split(" "),c=h[2].split(".");b=c[0]}}catch(l){}a._browser.flashVersion=b;a._browser.flash=b>=8}function zb(b){if(document.body)switch(document.readyState){case "complete":b();return;case "loaded":if(a._browser.webkit){b();return}break;case "interactive":case undefined:if(a._browser.firefox||a._browser.webkit){b();return}}if(document.addEventListener){document.addEventListener("DOMContentLoaded",b,false);document.addEventListener("load",b,false)}else if(window.attachEvent)window.attachEvent("onload",b);if(a._browser.ie&&document.attachEvent)document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);b()}})}function Te(b,a){b.innerHTML=a}function g(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else if(a.attachEvent)a.attachEvent("on"+b,c)}function n(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else if(a.detachEvent)a.detachEvent("on"+b,c)}function oe(){var a=K(Nb);if(a){var b=a.getAttribute(Dc);!b&&o(Lb("Could not find attribute '{0}' on element with id '{1}'.",Dc,Nb),ONEDRIVE_PREFIX);return b}else{o(Lb("Could not find element with id '{0}'.",Nb),ONEDRIVE_PREFIX);return null}}var Hb={registerOuterChannel:function(e,b,c,d,a){return k.registerChannel(e,b,c,d,a)},registerInnerChannel:function(c,b,a){return k.registerChannel(c,b,null,null,a)},isSupported:function(){return k.isSupported()}},k={_channels:[],isSupported:function(){return window.postMessage!=null},registerChannel:function(i,e,f,h,d){var b=k,c=b._channels,a=null;if(b.isSupported()){a=new Ac(i,e,f,h,d);if(c.length===0)g(window,"message",b._onMessage);c.push(a)}return a},unregisterChannel:function(d){var c=k,a=c._channels;for(var b=0;b<a.length;b++)if(a[b]==d){a.splice(b,1);break}if(a.length===0)n(window,"message",c._onMessage)},_onMessage:function(a){var d=k,a=a||window.event,c=Ee(a);if(c!=null){var b=d._findChannel(a,c);if(b!=null)switch(c.text){case Vc:b._onConnectReq(a.source,a.origin);break;case Uc:b._onConnectAck(a.source);break;default:b._onMessage(c.text)}}},_findChannel:function(g,f){var d=k,c=d._channels,e=Ne(g.origin);for(var b=0;b<c.length;b++){var a=c[b];if(dc(a._name,f.name)&&dc(a._allowedDomain,e))return a}return null}},Vc="@ConnectReq",Uc="@ConnectAck";function Ac(f,d,b,e,c){var a=this;a._name=f;a._allowedDomain=d;a._msgHandler=c;if(b){a._targetWindow=b;a._targetUrl=De(e);a._connect()}}Ac.prototype={_disposed:false,_connected:false,_allowedDomain:null,_targetWindow:null,_targetUrl:null,_msgHandler:null,_connectSchedule:-1,_pendingQueue:[],_recvQueue:[],dispose:function(){var a=this;if(!a._disposed){a._disposed=true;a._cancelConnect();k.unregisterChannel(a)}},send:function(c,d){var a=this;if(a._disposed)return;var b=ae(c,d);if(a._connected)a._post(b);else a._pendingQueue.push(b)},_connect:function(){var a=this;if(a._disposed||a._connected)return;var b=function(){a._post(Vc)};if(a._connectSchedule===-1){a._connectSchedule=window.setInterval(b,500);b()}},_post:function(b){var a=this,c=te(a._name,b);a._targetWindow.postMessage(c,a._targetUrl)},_onConnectReq:function(c,b){var a=this;if(!a._connected){a._connected=true;a._targetWindow=c;a._targetUrl=b;a._post(Uc);a._onConnected()}},_onConnectAck:function(b){var a=this;if(!a._connected){a._targetWindow=b;a._onConnected()}},_onConnected:function(){var a=this,c=a._pendingQueue;a._connected=true;for(var b=0;b<c.length;b++)a._post(c[b]);a._pendingQueue=[];a._cancelConnect()},_cancelConnect:function(){var a=this;if(a._connectSchedule!=-1){window.clearInterval(a._connectSchedule);a._connectSchedule=-1}},_onMessage:function(b){if(this._msgHandler){var a=Zd(b);this._msgHandler(a.cmd,a.args)}}};function De(b){var a=b.indexOf("://");if(a>=0){a=b.indexOf("/",a+3);if(a>=0)b=b.substring(0,a)}return b}function Ee(a){var b=null;if(!zc(a.origin)&&!zc(a.data)&&a.source!=null)b=se(a.data);return b}function te(a,b){return "<"+a+">"+b}function se(a){var c=null;if(a.charAt(0)=="<"){var b=a.indexOf(">");if(b>0){var d=a.substring(1,b),e=a.substr(b+1);c={name:d,text:e}}}return c}function ae(a,c){var b={cmd:a,args:c};return JSON.stringify(b)}function Zd(b){var a=JSON.parse(b);return a}if(window.WL)a.channel=Hb;else window.WL={channel:Hb};var kb={connect:"Connect",signIn:"Sign in",signOut:"Sign out",login:"Log in",logout:"Log out",skyDriveOpenPickerButtonText:"Open from OneDrive",skyDriveOpenPickerButtonTooltip:"Open from OneDrive",skyDriveSavePickerButtonText:"Save to OneDrive",skyDriveSavePickerButtonTooltip:"Save to OneDrive"};a._locale="en";a[I]="Web/DEVICE_"+Qd("5.5.8412.3001");a.testInit=function(b){if(b.env)a._settings.init(b.env);if(b.skydrive_uri)a._settings[v]=b.skydrive_uri;if(b[W])a[W]=b[W]};var eb={};eb[u]="https://apis.live.net/v5.0/";eb[v]="https://onedrive.live.com/";eb[j]="//js.live.net/v5.0/";var jb={};jb[u]="https://df.apis.live.net/v5.0/";jb[v]="https://onedrive.live.com/";jb[j]="//df-js.live.net/v5.0/";var ib={};ib[u]="https://apis.live-int.net/v5.0/";ib[v]="https://onedrive.live-int.com/";ib[j]="//js.live-int.net/v5.0/";var Y={};Y[u]="https://current.apis.live-tst.net/v5.0/";Y[v]="https://onedrive.live-int.com/";Y[j]="//current-js.live-int.net/v5.0/";var gb={};gb[u]="https://bvt.apis.live-tst.net/v5.0/";gb[v]="https://onedrive-bvt.live-int.com/";gb[j]="//bvt-js.live-int.net/v5.0/";a._settings={PROD:eb,DF:jb,INT:ib,CURRENT:Y,BVT:gb,init:function(b){b=b.toUpperCase();var c=this[b];if(c)h(c,a)}};a._settings.init("PROD");a[FILEDIALOG_PARAM_PICKER_SCRIPT]="wl.skydrivepicker.js";a.onloadInit()}})();