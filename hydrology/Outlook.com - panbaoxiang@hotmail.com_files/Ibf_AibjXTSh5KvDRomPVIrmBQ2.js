(function(){"use strict";function r(){return{SwEvent:HM.SwitchEvent.Unknown,SwEnterInfo:HM.SwitchEnterInfo.NotApplicable,SwSelectInfo:HM.SwitchSelectInfo.NotApplicable,SwExitInfo:HM.SwitchExitInfo.NotApplicable,SwEventInfo:"NA",SwState:HM.SwitchState.Unknown,SwPrevState:HM.SwitchState.Unknown,SwEntryID:HM.SwitchEntryPoint.Unknown}}var n=window.ol=window.ol||{},t=n.ImportAccountInstrumentationHelper={},i={EntryPoint:"swep",PreviousState:"swps"};t.ErrorMessageMaxLen=100,t.logSwitchEvent=function(u){var f,e,o;f=n.MergeOptions(r,u),e=$Cookie.getSessionCookie(i.PreviousState),e!=null&&(f.SwPrevState=parseInt(e)),o=$Cookie.getSessionCookie(i.EntryPoint),o!=null&&(f.SwEntryID=parseInt(o)),n.Cmd("log.importaccount").fire(f),t.savePreviousState(f.SwState)},t.maybeLogEnterImportTopAction=function(){n.config.pageManager.manifests.ImportAccount!=null&&n.pages.pageManager.getCurrentView()===n.config.pageManager.manifests.ImportAccount.name&&n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.ImportTop})},t.maybeLogFppTimeout=function(t,i){t!=null&&t.results!=null&&t.results.statusText==="abort"&&n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:i,SwEventInfo:"FPP timeout"})},t.savePreviousState=function(n){$Cookie.setSessionCookie(i.PreviousState,n)}})(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("hbigetswitchstatus",{fppMethod:"HbiGetSwitchStatus",tokenConfig:{friendlyName:"HbiGetSwitchStatus",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[],returnServerResults:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("hbigetcongratsdialogmanifest",{fppMethod:"HbiGetCongratsDialogManifest",tokenConfig:{friendlyName:"HbiGetCongratsDialogManifest",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[],returnServerResults:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbistopswitchjobrequest",{fppMethod:"SHbiStopSwitchJobRequest",tokenConfig:{friendlyName:"SHbiStopSwitchJobRequest",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"emailAddress",type:String}],returnServerResults:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbidetectimapandsmtpmailsettings",{fppMethod:"SHbiDetectImapAndSmtpMailSettings",tokenConfig:{friendlyName:"SHbiDetectImapAndSmtpMailSettings",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"accountAddress",type:Object},{name:"accountPassword",type:Object}],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbidetectimapandsmtpmailsettingsforswitch",{fppMethod:"SHbiDetectImapAndSmtpMailSettingsForSwitch",tokenConfig:{friendlyName:"SHbiDetectImapAndSmtpMailSettingsForSwitch",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"accountAddress",type:Object},{name:"accountPassword",type:Object},{name:"isYahoo",type:Boolean}],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbistartimapimport",{fppMethod:"SHbiStartImapImport",tokenConfig:{friendlyName:"SHbiStartImapImport",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"accountAddress",type:Object},{name:"encryptedUserName",type:Object},{name:"imapUserName",type:Object},{name:"accountPassword",type:Object},{name:"serverAddress",type:Object},{name:"serverPort",type:Object},{name:"isSsl",type:Boolean},{name:"smtpResult",type:Object}],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbistoresmtpsettings",{fppMethod:"SHbiStoreSmtpSettings",tokenConfig:{friendlyName:"SHbiStoreSmtpSettings",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"accountAddress",type:Object},{name:"encryptedUserName",type:Object},{name:"accountPassword",type:Object},{name:"serverAddress",type:Object},{name:"serverPort",type:Object},{name:"secureType",type:Object}],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbiverifyimapsettings",{fppMethod:"SHbiVerifyImapSettings",tokenConfig:{friendlyName:"SHbiVerifyImapSettings",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"accountAddress",type:Object},{name:"accountPassword",type:Object},{name:"imapUserName",type:Object},{name:"serverAddress",type:Object},{name:"serverPort",type:Object},{name:"isSsl",type:Object}],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbivalidateoauthimport",{fppMethod:"SHbiValidateOAuthImport",tokenConfig:{friendlyName:"SHbiValidateOAuthImport",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("dismissaliasupsellsuperbar",{fppMethod:"DismissAliasUpsellSuperbar",tokenConfig:{friendlyName:"DismissAliasUpsellSuperbar",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[],returnServerResults:!0})}(window._ol_jQuery||jQuery),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("shbivalidateimportstart",{fppMethod:"SHbiValidateImportStart",tokenConfig:{friendlyName:"SHbiValidateImportStart",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[],returnServerResults:!0,suppressServerErrors:!0})}(),function(){var n=ol.templateMap=ol.templateMap||{};n["#oAuthImportFlowNotImportedTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"oAuthImportFlowNotImportedTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,e,f=i.converters.html,u="";return u+='    <div class="c-InboxFlowDialog">        ',u+=f(n.description),u+='        <ul class="StandardPaddingSection NoBottomMarginSection">            <li>',u+=f(t.hlp("ol").GetString("InboxFlow.GmailImport.EmailDescription")),u+="<\/li>            <li>",u+=f(t.hlp("ol").GetString("InboxFlow.GmailImport.ContactsDescription")),u+='<\/li>        <\/ul>        <div class="LargePaddingSection">            <a id="FolderOptionsLink" href="#" ',u+=(e=t.hlp("sutra")("folderoptionslink"))!=r?e:"",u+=">                ",u+=f(t.hlp("ol").GetString("InboxFlow.GmailImport.FolderOptionLink.Label")),u+='            <\/a>        <\/div>        <div id="FolderOptionsSection" class="LargePaddingSection" style="display: none;">            ',u+=f(t.hlp("ol").GetString("InboxFlow.GmailImport.FolderOption.Title")),u+='            <div class="StandardPaddingSection">                <input type="radio" id="existingFolderId" name="folderOption" checked="checked" ',u+=(e=t.hlp("sutra")("existingfolderoptioninput"))!=r?e:"",u+='/>                <label for="existingFolderId">',u+=f(t.hlp("ol").GetString("InboxFlow.GmailImport.FolderOption.ExistingFolder")),u+='<\/label>            <\/div>            <div class="StandardPaddingSection">                <input type="radio" id="newFolderId" name="folderOption" ',u+=(e=t.hlp("sutra")("newfolderoptioninput"))!=r?e:"",u+='/>                <label for="newFolderId">',u+=f(t.hlp("ol").GetString("InboxFlow.GmailImport.FolderOption.NewFolder")),u+"<\/label>            <\/div>        <\/div>    <\/div>"}}},n["#oAuthImportFlowHasImportedTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"oAuthImportFlowHasImportedTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='    <div class="c-InboxFlowDialog">        ',u+=e(n.description),u+='        <div class="LargePaddingSection">            <a id="AnotherAccountOptionsLink" href="#" ',u+=(f=t.hlp("sutra")("anotheraccountoptionslink"))!=r?f:"",u+=">                ",u+=e(t.hlp("ol").GetString("InboxFlow.GmailImport.ConnectedAndImported.AnotherAccountOptionLink.Label")),u+='            <\/a>        <\/div>        <div id="AnotherAccountOptionsSection" class="LargePaddingSection" style="display: none;">            ',u+=e(t.hlp("ol").GetString("InboxFlow.GmailImport.ConnectedAndImported.AnotherAccountOption.Title")),u+='            <ul class="StandardPaddingSection NoBottomMarginSection">                <li>',u+=(f=n.removeConnectionDescription)!=r?f:"",u+="<\/li>                <li>",u+=(f=n.importEmailOnlyDescription)!=r?f:"",u+='<\/li>            <\/ul>        <\/div>        <div id="NoImapOptionsSection" class="LargePaddingSection" style="display: none;">            ',u+=(f=n.noImapOptionsDescription)!=r?f:"",u+"        <\/div>    <\/div>"}}},n["#inboxFlowImapImportTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxFlowImapImportTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+="          ",r+=u(t.hlp("ol").GetString("InboxFlow.ImapImport.Description.Gmail")),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxFlowImapImportTemplate/else",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+="          ",r+=u(t.hlp("ol").GetString("InboxFlow.ImapImport.Description")),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"inboxFlowImapImportTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='          <div>            <a class="imapImportAdvancedLink" href="#" ',u+=(f=t.hlp("sutra")("ImapAdvancedLink"))!=r?f:"",u+=">",u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.Link.AdvancedOptions")),u+"<\/a>          <\/div>          "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"label",tmplName:"inboxFlowImapImportTemplate/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+='            <label class="radioLabel" for="mmt_radio">',r+=u(t.hlp("ol").GetString("InboxFlow.ImapImport.PopSuggestion.FromPC.WithOlk")),r+"<\/label>            "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"label",tmplName:"inboxFlowImapImportTemplate/if/else",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+='            <label class="radioLabel" for="mmt_radio">',r+=u(t.hlp("ol").GetString("InboxFlow.ImapImport.PopSuggestion.FromPC")),r+"<\/label>            "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"IsOutlookSupported",props:{},args:[n.IsOutlookSupported]},{tmpl:2,params:"",props:{},args:[]}]},paths:["IsOutlookSupported"],_ctxs:"else"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"inboxFlowImapImportTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='          <li class="optionItem">            <input id="mmt_radio" type="radio" name="popSuggestOptions" value="mmt" checked="checked" ',u+=(f=t.hlp("sutra")("ImapPopSuggestionMmt"))!=r?f:"",u+="/>            ",u+=e("if",t,this,1),u+"          <\/li>          "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"inboxFlowImapImportTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='          <li class="optionItem">            <input id="imap_radio" type="radio" name="popSuggestOptions" value="imap" ',u+=(f=t.hlp("sutra")("ImapPopSuggestionAdvanced"))!=r?f:"",u+='/>            <label class="radioLabel" for="imap_radio">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.PopSuggestion.SetIMAP")),u+"<\/label>          <\/li>          "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"IsForceImapImportEnabled",props:{},args:[n.IsForceImapImportEnabled]},{tmpl:2,params:"",props:{},args:[]}]},paths:["IsForceImapImportEnabled"],_ctxs:"else"},{fn:function(n){return[{tmpl:3,params:"IsAdvancedOptionsEnabled",props:{},args:[n.IsAdvancedOptionsEnabled]}]},paths:["IsAdvancedOptionsEnabled"],_ctxs:"if"},{fn:function(n){return[{tmpl:4,params:"IsClientImportEnabled",props:{},args:[n.IsClientImportEnabled]}]},paths:["IsClientImportEnabled"],_ctxs:"if"},{fn:function(n){return[{tmpl:5,params:"IsAdvancedOptionsEnabled",props:{},args:[n.IsAdvancedOptionsEnabled]}]},paths:["IsAdvancedOptionsEnabled"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"inboxFlowImapImportTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i.converters.html,u="";return u+='  <div class="c-InboxFlowDialog">    <div class="c-ImapImportDialog" id="ImapImportDialog">      <div id="imapImportBasic" class="',u+=(f="imapImportBasic"+(n.ShowAdvancedDialog?" NoDisplay":""))!=r?f:"",u+="\" data-link=\"class{:'imapImportAdvanced' + ((ShowAdvancedDialog) ? ' NoDisplay' : '')}\">        <div class=\"captionText\" ",u+=(f=t.hlp("sutra")("ImapImportDialogText"))!=r?f:"",u+=">          ",u+=o("if",t,this,1),u+='        <\/div>        <div class="accountSettings">          <div class="inlineError" id="errorOnAddress" style="display:none"><\/div>          <div class="accountSettingslabel"><label for="imapImportEmailAddress">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.EmailAddress")),u+='<\/label><\/div>          <div><input id="imapImportEmailAddress" type="text" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("ImapEmailAddressInput"))!=r?f:"",u+='/><\/div>          <div class="inlineError" id="errorOnPassword" style="display:none"><\/div>          <div class="accountSettingslabel StandardPaddingSection"><label for="imapImportPassword">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.Password")),u+='<\/label><\/div>          <div><input id="imapImportPassword" type="password" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("ImapPasswordInput"))!=r?f:"",u+='/><\/div>        <\/div>        <div class="linkSection">          ',u+=o("if",t,this,2),u+='          <div class="StandardPaddingSection">            <a class="imapImportPrivacyLink" href="#" ',u+=(f=t.hlp("sutra")("ImapPrivacyLink"))!=r?f:"",u+=">",u+=e(t.hlp("ol").GetString("Footer.Privacy.Text")),u+="<\/a>          <\/div>        <\/div>      <\/div>      <!-- Template for AdvancedOptions - initially it's hidden -->      <div class=\"",u+=(f="imapImportAdvanced"+(n.ShowAdvancedDialog?"":" NoDisplay"))!=r?f:"",u+='" id="imapImportAdvanced" data-link="class{: \'imapImportAdvanced\' + ((ShowAdvancedDialog) ? \'\' : \' NoDisplay\')}">        <div class="captionText" id="captionTextAdvanced">          ',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.SettingCaption")),u+='        <\/div>        <div class="accountSettings">          <div class="accountSettingslabel">            <label for="imapImportEmailAddress">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.EmailAddress")),u+='<\/label>          <\/div>          <div>            <input id="imapImportEmailAddress" type="text" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("ImapEmailAddressInputAdvanced"))!=r?f:"",u+='/>          <\/div>          <div class="accountSettingslabel StandardPaddingSection">            <label for="imapImportUserName">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.Username")),u+='<\/label>          <\/div>          <div>            <input id="imapImportUserName" type="text" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("ImapUserNameInput"))!=r?f:"",u+='/>          <\/div>          <div class="accountSettingslabel StandardPaddingSection">            <label for="imapImportPassword">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.Password")),u+='<\/label>          <\/div>          <div>            <input id="imapImportPassword" type="password" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("ImapPasswordInputAdvanced"))!=r?f:"",u+='/>          <\/div>        <\/div>        <div class="serverSettings StandardPaddingSection">          <table class="StandardPaddingSection">            <tr>              <td class="imapImportServerPropertyCaption accountSettingslabel">                <label for="imapImportServerName">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.MailServerName")),u+='<\/label>              <\/td>              <td class="verticalSeparator"><\/td>              <td class="imapImportServerPropertyCaption accountSettingslabel">                <label for="imapImportServerPort">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.MailServerPort")),u+='<\/label>              <\/td>            <\/tr>            <tr>              <td>                <input id="imapImportServerName" type="text" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("ImapServerInput"))!=r?f:"",u+='/>              <\/td>              <td class="verticalSeparator"><\/td>              <td>                <select id="imapImportServerPort" ',u+=(f=t.hlp("sutra")("ImapPortDropdown"))!=r?f:"",u+='>                  <option value="993" ',u+=(f=t.hlp("sutra")("ImapPort993"))!=r?f:"",u+='>993<\/option>                  <option value="143" ',u+=(f=t.hlp("sutra")("ImapPort143"))!=r?f:"",u+='>143<\/option>                <\/select>              <\/td>            <\/tr>          <\/table>        <\/div>        <div class="connectionSettings StandardPaddingSection">          <!-- TODO(takua): Do we want to change default check or uncheck ? -->          <input type="checkbox" id="imapImportSecureConnection" ',u+=(f=t.hlp("sutra")("ImapSecureConnection"))!=r?f:"",u+=' checked="checked" />          <label for="imapImportSecureConnection">            ',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.SecureConnection")),u+='          <\/label>        <\/div>        <div class="linkSection">          <div>            <a class="importPopSuggestLink" href="#" ',u+=(f=t.hlp("sutra")("ImapPOPSuggestLink"))!=r?f:"",u+=">",u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.Link.NonImap")),u+='<\/a>          <\/div>          <div class="StandardPaddingSection">            <a class="imapImportPrivacyLink" href="#" ',u+=(f=t.hlp("sutra")("ImapPrivacyLink"))!=r?f:"",u+=">",u+=e(t.hlp("ol").GetString("Footer.Privacy.Text")),u+='<\/a>          <\/div>        <\/div>      <\/div>      <!-- Template for Pop Suggestion - initially it\'s hidden -->      <div class="popSuggestion" id="popSuggestion" style="display:none">        <div class="descriptionText">        <\/div>        <ul class="radioButtonOptions" ',u+=(f=t.hlp("sutra")("ImapPopSuggestions"))!=r?f:"",u+=">          ",u+=o("if",t,this,3),u+='          <li class="optionItem">            <input id="popagg_radio" type="radio" name="popSuggestOptions" value="popagg" data-link="{isChecked:!IsClientImportEnabled}" ',u+=(f=t.hlp("sutra")("ImapPopSuggestionPopAgg"))!=r?f:"",u+='/>            <label class="radioLabel" for="popagg_radio">',u+=e(t.hlp("ol").GetString("InboxFlow.ImapImport.PopSuggestion.FromPOP3")),u+="<\/label>          <\/li>          ",u+=o("if",t,this,4),u+"        <\/ul>      <\/div>    <\/div>  <\/div>"}}},n["#inboxFlowYahooImportTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"inboxFlowYahooImportTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='  <div class="c-InboxFlowDialog">    <div class="c-YahooImportDialog" id="YahooImportDialog">      <div class="yahooImport" id="yahooImport">        <div class="captionText" ',u+=(f=t.hlp("sutra")("yahooimportdialogtext"))!=r?f:"",u+=">          ",u+=e(t.hlp("ol").GetString("InboxFlow.YahooImport.NotConnected.Description")),u+='        <\/div>        <div class="LargePaddingSection accountSettings">          <div class="inlineError NoDisplay" id="errorOnAddress"><\/div>          <div class="accountSettingslabel"><label for="yahooImportEmailAddress">',u+=e(t.hlp("ol").GetString("InboxFlow.YahooImport.EmailAddress")),u+='<\/label><\/div>          <div><input id="yahooImportEmailAddress" type="text" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("yahooemailaddressinput"))!=r?f:"",u+='/><\/div>          <div class="inlineError NoDisplay" id="errorOnPassword"><\/div>          <div class="accountSettingslabel StandardPaddingSection"><label for="yahooImportPassword">',u+=e(t.hlp("ol").GetString("InboxFlow.YahooImport.Password")),u+='<\/label><\/div>          <div><input id="yahooImportPassword" type="password" maxlength="',u+=(f=n.MaxInputLength)!=r?f:"",u+='" data-link="maxlength{:MaxInputLength}" ',u+=(f=t.hlp("sutra")("yahoopasswordinput"))!=r?f:"",u+='/><\/div>        <\/div>      <\/div>      <!-- Template for Options - initially it\'s hidden -->      <div class="FolderOptionsSection LargePaddingSection NoDisplay">            ',u+=e(t.hlp("ol").GetString("InboxFlow.YahooImport.FolderOption.Title")),u+='            <div class="StandardPaddingSection">                <input type="radio" id="existingFolderId" name="folderOption" checked="checked" ',u+=(f=t.hlp("sutra")("existingfolderoptioninput"))!=r?f:"",u+='/>                <label for="existingFolderId">',u+=e(t.hlp("ol").GetString("InboxFlow.YahooImport.FolderOption.ExistingFolder")),u+='<\/label>            <\/div>            <div class="StandardPaddingSection">                <input type="radio" id="newFolderId" name="folderOption" ',u+=(f=t.hlp("sutra")("newfolderoptioninput"))!=r?f:"",u+='/>                <label for="newFolderId">',u+=e(t.hlp("ol").GetString("InboxFlow.YahooImport.FolderOption.NewFolder")),u+='<\/label>            <\/div>        <\/div>        <div class="linkSection">          <div class="LargePaddingSection">            <a class="yahooImportOptionsLink" href="#" ',u+=(f=t.hlp("sutra")("yahoooptionslink"))!=r?f:"",u+=">",u+=e(t.hlp("ol").GetString("InboxFlow.YahooImport.Link.Options")),u+='<\/a>          <\/div>          <div class="StandardPaddingSection">            <a class="yahooImportPrivacyLink" href="#" ',u+=(f=t.hlp("sutra")("yahooprivacylink"))!=r?f:"",u+=">",u+=e(t.hlp("ol").GetString("Footer.Privacy.Text")),u+"<\/a>          <\/div>        <\/div>    <\/div>  <\/div>"}}},n["#SetupForwardingDialogForGmailTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"SetupForwardingDialogForGmailTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='    <div class="c-InboxFlowDialog">        ',u+=e(n.description),u+='        <div class="XLargePaddingSection">            ',u+=e(t.hlp("ol").GetString("InboxFlow.ImportAccountCongratsDialog.SetupForwardingFromGmail.ForwardingDescription")),u+='        <\/div>        <div class="XLargePaddingSection">            ',u+=(f=t.hlp("ol").GetString("InboxFlow.ImportAccountCongratsDialog.DefaultDialog.Note"))!=r?f:"",u+"        <\/div>    <\/div>"}}},n["#SetupForwardingDialogForOtherProviderTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"SetupForwardingDialogForOtherProviderTemplate",htmlTag:"div",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+='    <div class="c-InboxFlowDialog">        ',r+=u(n.description),r+='        <div class="XLargePaddingSection">            ',r+=u(n.forwardingDescription),r+"        <\/div>    <\/div>"}}},n["#ImportAccountDefaultCongratsDialogTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"ImportAccountDefaultCongratsDialogTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='    <div class="c-InboxFlowDialog">        ',u+=e(t.hlp("ol").GetString("InboxFlow.ImportAccountCongratsDialog.DefaultDialog.Description")),u+='        <div class="XLargePaddingSection">            ',u+=(f=t.hlp("ol").GetString("InboxFlow.ImportAccountCongratsDialog.DefaultDialog.Note"))!=r?f:"",u+='        <\/div>        <div class="XLargePaddingSection">            ',u+=(f=n.helpLink)!=r?f:"",u+"        <\/div>    <\/div>"}}},n["#aliasCreateRuleTmpl"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"data=#data",props:{data:n},args:[]}]},paths:["#data"],_ctxs:"aliasCreateRuleDialog"}],_is:"template",allowCode:!0,tmplName:"aliasCreateRuleTmpl",htmlTag:"",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="  ",r+=u("aliasCreateRuleDialog",t,this,1),r+""}}},n["#aliasCreateRuleDialogTmpl"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Error",props:{},args:[n.Error]}},paths:["Error"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"aliasCreateRuleDialogTmpl/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='    <div class="errorMsg" ',u+=(f=t.hlp("sutra")("deliveryfoldererror"))!=r?f:"",u+=">      ",u+=e("html",t,1),u+"    <\/div>    "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"ul",tmplName:"aliasCreateRuleDialogTmpl/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='    <ul class="cOptionsRadio">      <li>        <input type="checkbox" name="aliasDefaultFrom" id="acrd_defaultFrom" value="true" data-link="{:DefaultFrom:}" ',u+=(f=t.hlp("sutra")("deliveryfolderdefaultfromcheckbox"))!=r?f:"",u+=' />        <label for="acrd_defaultFrom">          ',u+=e(t.hlp("ol").GetString("AliasRenameFlow.Alias.DefaultFromLabel")),u+"        <\/label>      <\/li>    <\/ul>    "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"aliasCreateRuleDialogTmpl/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+="            ",r+=u(t.hlp("ol").GetString("Options.Aggregation.Setup.ExistingFolderLabel")),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"aliasCreateRuleDialogTmpl/else",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+="            ",r+=u(t.hlp("ol").GetString("Options.Aggregation.Setup.InboxLabel")),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"ExistingFolder && ExistingFolder.Name",props:{},args:[n.ExistingFolder&&n.ExistingFolder.Name]}},paths:["ExistingFolder","ExistingFolder.Name"],_ctxs:":"},{fn:function(n){return[{tmpl:0,params:'data=FolderPickerViewmodel ~filterFn=FolderPickerViewmodel.FilterFn ~menuType="MoveTo" ',props:{data:n.FolderPickerViewmodel},ctx:{filterFn:n.FolderPickerViewmodel.FilterFn,menuType:"MoveTo"},args:[]}]},paths:["FolderPickerViewmodel"],_ctxs:"containerPickerControl"}],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"aliasCreateRuleDialogTmpl/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='        <span class="folderPicker c_mcp" ',u+=(f=t.hlp("sutra")("inboxtoolbarmovetoitem"))!=r?f:"",u+='>          <a href="#" class="folderPickerLink c_ml">            <span id="menuCaption">',u+=o("",t,1),u+='<\/span>&nbsp;<img class="ExcoOpenNormal" src="./clear.gif"/>          <\/a>          <ul class="folderDropdown c-ContainerPicker c_m t_hovl">',u+=e("containerPickerControl",t,this,2),u+"<\/ul>        <\/span>        "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Error",props:{},args:[n.Error]}]},paths:["Error"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"aliasCreateRuleDialogTmpl",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,s=i.converters.html,u="";return u+='  <div class="c-AliasCreateRule" ',u+=(f=t.hlp("sutra")("deliveryfoldercontrol"))!=r?f:"",u+='>    <div class="cOptionsText" ',u+=(f=t.hlp("sutra")("deliveryfoldertext"))!=r?f:"",u+=">      ",u+=s(t.hlp("tag").getBody()),u+="    <\/div>    ",u+=e("if",t,this,1),u+="    ",u+=e("if",t,this,[{tmpl:2,params:"SuggestDefaultFrom",props:{},args:[n.SuggestDefaultFrom]}]),u+='    <div class="',u+=o("cssClassHideDefaultFrom",t,{params:"'cOptionsText' DefaultFrom SuggestDefaultFrom",props:{},args:["cOptionsText",n.DefaultFrom,n.SuggestDefaultFrom]}),u+='" data-link="class{cssClassHideDefaultFrom:\'cOptionsText\' DefaultFrom SuggestDefaultFrom}" ',u+=(f=t.hlp("sutra")("deliveryfolderoptionstext"))!=r?f:"",u+=">      ",u+=s(t.hlp("tag").getRuleText()),u+='    <\/div>    <ul class="',u+=o("cssClassHideDefaultFrom",t,{params:"'cOptionsRadio' DefaultFrom SuggestDefaultFrom",props:{},args:["cOptionsRadio",n.DefaultFrom,n.SuggestDefaultFrom]}),u+='" data-link="class{cssClassHideDefaultFrom:\'cOptionsRadio\' DefaultFrom SuggestDefaultFrom}" ',u+=(f=t.hlp("sutra")("deliveryfolderoptions"))!=r?f:"",u+=">      <li ",u+=(f=t.hlp("tag").canCreateFolders()?"":"class='NoDisplay'")!=r?f:"",u+='>        <input type="radio" name="aliasFolderSel" id="acrd_newFolder" value="true" data-link="{boolToStr:UseNewFolder:strToBool}" ',u+=(f=t.hlp("sutra")("deliveryfoldernewfolderradiobutton"))!=r?f:"",u+=' />        <label for="acrd_newFolder">          ',u+=s(t.hlp("ol").GetString("AliasRenameFlow.NewFolderLabel")),u+='        <\/label>        <input type="text" class="newFolderName cOptionsContentInput" maxlength="',u+=o("attr",t,{params:"~tag.maxFolderNameLength()",props:{},args:[t.hlp("tag").maxFolderNameLength()]}),u+='" value="',u+=o("attr",t,{params:"NewFolder",props:{},args:[n.NewFolder]}),u+='" data-link="{:NewFolder:}" ',u+=(f=t.hlp("sutra")("deliveryfoldernewfoldername"))!=r?f:"",u+=' />      <\/li>      <li>        <input type="radio" name="aliasFolderSel" id="acrd_existingFolder" value="false" data-link="{boolToStr:UseNewFolder:strToBool}" ',u+=(f=t.hlp("sutra")("deliveryfolderexistingfolderradiobutton"))!=r?f:"",u+=' />        <label for="acrd_existingFolder">          ',u+=e("if",t,this,[{tmpl:3,params:"~tag.hasCustomFolders()",props:{},args:[t.hlp("tag").hasCustomFolders()]},{tmpl:4,params:"",props:{},args:[]}]),u+="        <\/label>        ",u+=e("if",t,this,[{tmpl:5,params:"~tag.hasCustomFolders()",props:{},args:[t.hlp("tag").hasCustomFolders()]}]),u+"      <\/li>    <\/ul>  <\/div>"}}},n["#aliasCreationSuperbarContentTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"aliasCreationSuperbarContentTemplate",htmlTag:"h3",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='  <h3 class="Title" ',u+=(f=t.hlp("sutra")("SuperbarContentTitle"))!=r?f:"",u+=" >    ",u+=e(t.hlp("ol").GetString("Easi.AliasUpsellSuperbar.Title")),u+='  <\/h3>  <span class="Text" ',u+=(f=t.hlp("sutra")("SuperbarContentText"))!=r?f:"",u+=" >    ",u+=e(t.hlp("ol").GetString("Easi.AliasUpsellSuperbar.Description")),u+"  <\/span>"}}},n["#_indicatorTmpl"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"_indicatorTmpl",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="  <li id='ImportProgress' class='c_mcp'>    <a id='ImportProgressLink' class='uxfa_ml c_ml is_ellipsis' href='#' ",u+=(f=t.hlp("sutra")("ImportStatusMenu"))!=r?f:"",u+=">      <span id='ImportProgressText' class='c_mlu'>        ",u+=(f=n.statusText)!=r?f:"",u+"      <\/span>    <\/a>  <\/li>"}}},n["#_statusMenuTmpl"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"_statusMenuTmpl",htmlTag:"ul",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+="  <ul id='ImportStatusMenuContent' class='cm_menu c_m' ",u+=(f=t.hlp("sutra")("ImportStatusMenuItem"))!=r?f:"",u+=">    <div id=\"ISPropertyStatus\"><\/div>    <li class='is_separator'>      <span class='c_ms' />    <\/li>    <li class='is_item'>      <a id='ImportStop' class='is_ellipsis' href='#'",u+=(f=t.hlp("sutra")("StopImportingItem"))!=r?f:"",u+=">        ",u+=e(n.stopButtonLabel),u+"      <\/a>    <\/li>  <\/ul>"}}},n["#_propertyStatusListTmpl"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"_propertyStatusListTmpl",htmlTag:"",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="  ",r+=u("for",t,this,[{tmpl:0,params:'propertyStatuses tmpl="#_propertyStatusTmpl" ',props:{tmpl:"#_propertyStatusTmpl"},args:[n.propertyStatuses]}]),r+""}}},n["#_propertyStatusTmpl"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"_propertyStatusTmpl/if",fn:{fn:function(n,t,i){var i=i||jsviews;return"    <div class='is_smalltopmargin'><\/div>    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"_propertyStatusTmpl",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="  <li id='",u+=(f=n.menuItemId)!=r?f:"",u+="' class='is_item' ",u+=(f=n.menuItemSutra)!=r?f:"",u+=">    ",u+=e("if",t,this,[{tmpl:1,params:"#index > 0",props:{},args:[t.index>0]}]),u+="    <div class='TextSemiBold is_property is_ellipsis'>        ",u+=(f=n.jobTaskType)!=r?f:"",u+="    <\/div>    <div class='is_status is_ellipsis'>        ",u+=(f=n.statusText)!=r?f:"",u+"    <\/div>  <\/li>"}}},n["#_stopFlyoutTmpl"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"_stopFlyoutTmpl",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+="  <div class='is_stopflyout'>    <div>        ",u+=(f=n.accountText)!=r?f:"",u+="    <\/div>    <div>        &nbsp;    <\/div>    <div>        ",u+=e(t.hlp("ol").GetString("Options.ImportAccount.Progress.StopFlyoutNote")),u+"    <\/div>  <\/div>"}}}}(),function(n,t){"use strict";var i={attr:"html",flowManager:null,init:function(){var i=this,t,r=n.config.inboxFlow.configs;for(i.flowManager=[],t=0;t<r.length;t++)switch(r[t].ID){case HM.InboxFlowID.PopDeleteBar:i.flowManager.push(new n.inboxFlow.PopDeleteManager(r[t].Manifest));break;case HM.InboxFlowID.AliasCreationFREDialog:case HM.InboxFlowID.AliasCreationNormalDialog:case HM.InboxFlowID.AliasCreationSuperbar:i.flowManager.push(new n.inboxFlow.aliasCreationUpsellManager(r[t].ID,r[t].Manifest));break;case HM.InboxFlowID.GmailImportNormalDialog:i.flowManager.push(new n.oAuthImportDialogsManager(r[t].Manifest));break;case HM.InboxFlowID.YahooImportBasicDialog:n.config.appSettings.IsYahooImportAutoConfigEnabled?i.flowManager.push(new n.yahooImportDialogsManager(r[t].Manifest)):i.flowManager.push(new n.ImapImportDialogsManager(r[t].Manifest));break;case HM.InboxFlowID.AliasCreateRuleDialog:i.flowManager.push(new n.inboxFlow.aliasCreateRuleDialogManager(r[t].Manifest));break;case HM.InboxFlowID.ImapImportNormalDialog:i.flowManager.push(new n.ImapImportDialogsManager(r[t].Manifest));break;case HM.InboxFlowID.ImportAccountCongratsDialog:i.flowManager.push(new n.inboxFlow.ImportAccountCongratsDialogsManager(r[t].Manifest));break;case HM.InboxFlowID.ImportProgressIndicator:n.inboxFlow.importProgressIndicator=new n.inboxFlow.importProgressIndicatorManager(r[t].Manifest),i.flowManager.push(n.inboxFlow.importProgressIndicator);break;case HM.InboxFlowID.ImportAccountThrottlingDialog:i.flowManager.push(new n.inboxFlow.ImportAccountThrottlingDialogsManager);break;case HM.InboxFlowID.BrowserSupportUpsellBar:i.flowManager.push(new n.inboxFlow.BrowserSupportUpsellBarManager);break;case HM.InboxFlowID.CRMUpsell:i.flowManager.push(new n.inboxFlow.CRMUpsellManager(r[t].Manifest));break;case HM.InboxFlowID.AutoForwardingReminder:i.flowManager.push(new n.inboxFlow.AutoForwardingReminderManager(r[t].Manifest));break;case HM.InboxFlowID.CreateRuleDialog:i.flowManager.push(new n.inboxFlow.CreateRuleDialogManager(r[t].Manifest));break;case HM.InboxFlowID.Normal:break;default:throw new Error("Unsupported inbox flow ID");}for(t=0;t<i.flowManager.length;t++)i.flowManager[t].initializeNotification()},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){for(var t=this,n=0;n<t.flowManager.length;n++)t.flowManager[n].showNotification()}};t.views.tags({inboxFlowControl:i})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.inboxFlow=n.inboxFlow||{},r=i.AutoForwardingReminderManager=function(i){var r=this;r.bottomBar=null,r.manifest=i,r.userDomain=n.String.emailDomain(r.manifest.importedAddress),r.initializeNotification=function(){r.bottomBar=wLive.Controls.Notifications.createBottomBar({content:n.GetString("InboxFlow.AutoForwardingReminder.Title").format(r.manifest.importedAddress.encodeHtml()),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Explicit,buttons:{action:n.GetString("InboxFlow.AutoForwardingReminder.ActionButton.Label"),close:n.GetString("InboxFlow.AutoForwardingReminder.CloseButton.Label")}})},r.showNotification=function(){t(r.bottomBar).on("beforeshow",t.proxy(r.onBeforeShow,r));t(window).on("beforeunload.autoforwardreminder",t.proxy(r.onBeforeUnload,r));r.bottomBar.show().then(function(i){if(t(window).off("beforeunload.autoforwardreminder"),i.buttonClicked==="action")return n.Cmd("log.upsellautoforward").fire({UpsellEvent:HM.UpsellEvent.ExitNext,UpsellDomain:r.userDomain}),$BSI.navigateTo(r.manifest.helpPageUrl,"_blank"),!1;if(i.buttonClicked==="close")return n.Cmd("log.upsellautoforward").fire({UpsellEvent:HM.UpsellEvent.ExitDismiss,UpsellDomain:r.userDomain}),!1;throw new Error("Unexpected event");})},r.onBeforeShow=function(){n.Cmd("log.upsellautoforward").fire({UpsellEvent:HM.UpsellEvent.Show,UpsellDomain:r.userDomain}),t(r.bottomBar).off("beforeshow")},r.onBeforeUnload=function(){n.Cmd("log.upsellautoforward").fire({UpsellEvent:HM.UpsellEvent.ExitDismiss,UpsellDomain:r.userDomain}),t(window).off("beforeunload.autoforwardreminder")}}}(window.ol,window.originaljQuery||window.jQuery),function(){"use strict";var r=ol.inboxFlow=ol.inboxFlow||{},n="noBrowserUpsell",t={action:1,alternate:2,close:0},i;ol.Cmd.register({"instrument.bsupsell":{args:[{name:"buttonClicked",type:String}]}}),i=ol.inboxFlow.BrowserSupportUpsellBarManager=function(){var i=this;i.initializeNotification=function(){ol.data.InstrumentationModel.instance.registerAction("A.IEXPUpsl",HM.createInstrumentationAction({conditions:[HM.createInstrumentationCondition({command:"instrument.bsupsell"})],datapoints:[HM.createInstrumentationDatapoint({ref:"Common"}),HM.createInstrumentationDatapoint({name:"diexpupsl",type:"number",src:function(n){return t[n.cmd.args.buttonClicked]}})]}))},i.showNotification=function(){try{localStorage&&!localStorage[n]&&sessionStorage&&!sessionStorage[n]&&(sessionStorage[n]=!0,wLive.Controls.Notifications.createBottomBar({content:ol.GetString("BrowserSupport.FirstParagraph"),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Explicit,buttons:{action:ol.GetString("BrowserSupport.UpsellBar.Action"),alternate:ol.GetString("BrowserSupport.UpsellBar.Alternate"),close:ol.GetString("BrowserSupport.UpsellBar.Close")}}).show().then(function(t){var i=t.buttonClicked;ol.Cmd("instrument.bsupsell").fire({buttonClicked:i}),i==="action"?$BSI.navigateTo(ol.GetString("Market.BrowserSupport.IE.Link.Url")):i==="alternate"&&(localStorage[n]=!0)}))}catch(i){}}}}(),function(n){"use strict";var t=ol.inboxFlow=ol.inboxFlow||{},i=ol.inboxFlow.CRMUpsellManager=function(t){var i=this,r=t;i.initializeNotification=function(){var i=[t.crmScriptUrl];t.bubbleScriptUrl&&i.push(t.bubbleScriptUrl),Loader.load({js:i,css:[t.crmStyle]},n.noop)},i.showNotification=n.noop}}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=n.inboxFlow=n.inboxFlow||{},i=t.CreateRuleDialogManager=function(t){this.manifest=t;var i=this;i.initializeNotification=function(){},i.showNotification=function(){for(var u=[],f=[],r,i=0;i<t.conditions.length;i++)u.push(t.conditions[i]);for(r=0;r<t.actions.length;r++)f.push(t.actions[r]);f.length>0||u.length>0?n.Cmd("createprefilledrule").fire({entryPoint:HM.InstrumentationEntryPoint.RRU,actions:f,conditions:u}):n.Cmd("createrule").fire({entryPoint:HM.InstrumentationEntryPoint.RRU})}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.oAuthImportDialogsManager=function(i){this.dialog=null,this.manifest=i,this.enterInfo=HM.SwitchEnterInfo.NotApplicable,this.exitInfo=HM.SwitchExitInfo.NotApplicable,this.initializeNotification=function(){var i=this,s="",r=t("<div />"),h="",c="",a,v,e,o,y,u,p,w,f,l;if(i.manifest.isRetry){i.enterInfo=HM.SwitchEnterInfo.ConnectedImported,s=n.GetString("InboxFlow.GmailImport.ConnectedAndImported.Title"),h=n.GetString("InboxFlow.GmailImport.TryAgain"),c=n.GetString("InboxFlow.GmailImport.Cancel"),a={description:n.GetString("InboxFlow.GmailImport.ConnectedAndImported.Description.TextFormat").format(i.manifest.importedAddress),removeConnectionDescription:n.GetString("InboxFlow.GmailImport.ConnectedAndImported.AnotherAccountOption.RemoveConnection.TextFormat").format("RemoveConnectionLink","#",n.getSutra("removeconnectionlink"),i.manifest.importedAddress.encodeHtml()),importEmailOnlyDescription:n.GetString("InboxFlow.GmailImport.ConnectedAndImported.AnotherAccountOption.EmailOnly.TextFormat").format("EmailOnlyLink","#",n.getSutra("importemailonlylink")),noImapOptionsDescription:n.GetString("InboxFlow.GmailImport.ConnectedAndImported.AnotherAccountOption.TextFormat").format("RemoveConnectionLinkForNoImapOption","#",n.getSutra("removeconnectionlinkfornoimapoption"),i.manifest.importedAddress.encodeHtml())},u=t.templates("#oAuthImportFlowHasImportedTemplate"),r.html(u.render(a,n.getContextObject())),f=t(r.find("#AnotherAccountOptionsLink").get(0));f.on("click",t.proxy(i.onAnotherAccountOptionsLinkClicked,i));if(i.manifest.isImapImportEnabled){e=t(r.find("#RemoveConnectionLink").get(0));e.on("click",t.proxy(i.onRemoveConnectionLinkClicked,i));v=t(r.find("#EmailOnlyLink").get(0));v.on("click",t.proxy(i.onEmailOnlyLinkClicked,i))}else{e=t(r.find("#RemoveConnectionLinkForNoImapOption").get(0));e.on("click",t.proxy(i.onRemoveConnectionLinkClicked,i))}}else{o=i.manifest.connectedAddress!=null&&i.manifest.connectedAddress.length>0,i.enterInfo=o?HM.SwitchEnterInfo.ConnectedNotImported:HM.SwitchEnterInfo.NotConnected,s=o?n.GetString("InboxFlow.GmailImport.ConnectedButNotImported.Title").format(i.manifest.connectedAddress.encodeHtml()):n.GetString("InboxFlow.GmailImport.NotConnected.Title"),h=n.GetString("InboxFlow.GmailImport.Start"),c=i.manifest.entryPoint==HM.SwitchEntryPoint.Option||i.manifest.entryPoint==HM.SwitchEntryPoint.Superbar?n.GetString("InboxFlow.GmailImport.Cancel"):n.GetString("InboxFlow.GmailImport.NoThanks"),y=o?n.GetString("InboxFlow.GmailImport.ConnectedButNotImported.Description").format(i.manifest.connectedAddress):n.GetString("InboxFlow.GmailImport.NotConnected.Description"),u=t.templates("#oAuthImportFlowNotImportedTemplate"),r.html(u.render({description:y},n.getContextObject())),i.manifest.errorType!=HM.ImportStartErrorType.NoError&&i.manifest.folderMappingOption===HM.SwitchFolderMappingOption.Subfolder?(p=t(r.find("#newFolderId").get(0)),p.prop("checked","checked")):(w=t(r.find("#existingFolderId").get(0)),w.prop("checked","checked")),f=t(r.find("#FolderOptionsLink").get(0));f.on("click",t.proxy(i.onFolderOptionsLinkClicked,i))}l={title:s,content:r,buttons:{action:h,close:c},options:{dismissOnButtonClick:!1}},i.manifest.errorType!=HM.ImportStartErrorType.NoError&&(l.notificationArea=i.getNotificationContentForError(i.manifest.errorType)),i.dialog=wLive.Controls.Notifications.createModalDialog(l),t(i.dialog).bind({"buttonclick.dialog":function(n,t,r){if(r==="action")i.onStartButtonClicked(n);else if(r==="close")i.onCloseButtonClicked(n);else throw new Error(0,"Unexpected button name");},beforedismiss:function(){i.logExitEvent(),i.cleanupEventHandlers()}})},this.showNotification=function(){var i=this;n.Cmd("openinboxflowfolderoptions").subscribe(i.openFolderOptionsSection),n.Cmd("openinboxflowanotheraccountoptions").subscribe(t.proxy(i.openAnotherAccountOptionsSection,i)),n.Cmd("removecurrentconnection").subscribe(t.proxy(i.checkImportStatusAndgoToRemoveConnectionUrl,i)),n.Cmd("openemailonlydialog").subscribe(t.proxy(i.openImapImportDialog,i)),n.Cmd("startoauthimport").subscribe(t.proxy(i.startOAuthImport,i));t(i.dialog).on("aftershow",t.proxy(i.setKeydownEvent,i));i.dialog.show();t(window).on("beforeunload.importaccount",t.proxy(i.onBeforeUnload,i));n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.ImportGmail,SwEnterInfo:i.enterInfo})},this.onFolderOptionsLinkClicked=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportGmail,SwSelectInfo:HM.SwitchSelectInfo.Options}),n.Cmd("openinboxflowfolderoptions").fire({e:t.originalEvent}),t.preventDefault()},this.onAnotherAccountOptionsLinkClicked=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportGmail,SwSelectInfo:HM.SwitchSelectInfo.Options}),n.Cmd("openinboxflowanotheraccountoptions").fire({e:t.originalEvent}),t.preventDefault()},this.onRemoveConnectionLinkClicked=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportGmail,SwSelectInfo:HM.SwitchSelectInfo.Gmail}),n.Cmd("removecurrentconnection").fire({e:t.originalEvent}),t.preventDefault()},this.onEmailOnlyLinkClicked=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportGmail,SwSelectInfo:HM.SwitchSelectInfo.Imap}),n.Cmd("openemailonlydialog").fire({e:t.originalEvent}),t.preventDefault()},this.onStartButtonClicked=function(t){var i=this;n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportGmail,SwSelectInfo:HM.SwitchSelectInfo.Next}),i.disableInputControls(),n.Cmd("startoauthimport").fire({e:t.originalEvent}),t.preventDefault()},this.onCloseButtonClicked=function(t){var i=this;n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportGmail,SwSelectInfo:HM.SwitchSelectInfo.Close}),i.dialog.dismiss(),n.ImportAccountInstrumentationHelper.maybeLogEnterImportTopAction(),t.preventDefault()},this.openFolderOptionsSection=function(){t("#FolderOptionsLink").hide(),t("#FolderOptionsSection").show()},this.openAnotherAccountOptionsSection=function(){var n=this;t("#AnotherAccountOptionsLink").hide(),n.manifest.isImapImportEnabled?t("#AnotherAccountOptionsSection").show():t("#NoImapOptionsSection").show()},this.checkImportStatusAndgoToRemoveConnectionUrl=function(){var i=this,u=i.dialog.notificationArea(),r;u.hide(),r=t("<div><\/div>"),r.appendTo(".c-InboxFlowDialog"),n.SHbiFppLoader.loadFppRequest(r,"shbivalidateoauthimport",{},6e4).then(function(t,r){var e,u,f,o;if(r==null||r.length==0)throw new Error(0,"Invalid server result at ValidateOAuthImport request.");for(e=!1,u=0;u<r.length;u++)if(f=r[u],f&&f.type===HM.DLReturnType.SuccessBoolean){f.success?(i.exitInfo=HM.SwitchExitInfo.ConnectEdit,$BSI.navigateTo(i.manifest.editUrl)):(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:HM.SwitchState.ImportGmail,SwEventInfo:"Import in progress"}),o=i.getNotificationContentForError(HM.ImportStartErrorType.ImportProcessIsRunning),i.showError(o),i.enableInputControls()),e=!0;break}if(!e)throw new Error(0,"Invalid server result at ValidateOAuthImport request.");},function(t){n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,HM.SwitchState.ImportGmail);var r=i.getNotificationContentForError(HM.ImportStartErrorType.Other);i.showError(r),i.enableInputControls()})},this.openImapImportDialog=function(){var i=this,t;i.exitInfo=HM.SwitchExitInfo.ImportImapBasic,i.dialog.dismiss(),t=new n.ImapImportDialogsManager(this.manifest.imapImportManifest),t.initializeNotification(),t.showNotification()},this.getNotificationContentForError=function(i){var f=this,u="",r;return u=i===HM.ImportStartErrorType.ImportProcessIsRunning?n.GetString("InboxFlow.GmailImport.Error.ImportProcessIsRunning"):i===HM.ImportStartErrorType.FailedToGetPermission?n.GetString("InboxFlow.GmailImport.Error.InsufficientPermissions"):n.GetString("InboxFlow.GmailImport.Error.Generic"),r=t("<span><\/span>").addClass("c-InboxFlowDialog"),r.append(t("<span><\/span>").addClass("ErrorMessage").text(u)),r},this.showError=function(n){var t=this,i=t.dialog.notificationArea();i.html(n),i.show(),t.dialog.reposition()},this.disableInputControls=function(){var n=this,i,r;n.dialog.getButton({buttonName:"action"}).prop("disabled",!0),n.dialog.getButton({buttonName:"close"}).prop("disabled",!0),i=t(n.dialog.content()).find("a:visible"),t.each(i,function(n,i){var r=t(i);r.addClass("DisabledLink"),r.off("click");r.on("click",function(){return!1})}),r=t(n.dialog.content()).find("#FolderOptionsSection input"),t.each(r,function(n,i){t(i).prop("disabled",!0)})},this.enableInputControls=function(){var n=this,i,r;n.dialog.getButton({buttonName:"action"}).prop("disabled",!1),n.dialog.getButton({buttonName:"close"}).prop("disabled",!1),i=[{$link:t("#FolderOptionsLink"),onClickFunction:n.onFolderOptionsLinkClicked},{$link:t("#AnotherAccountOptionsLink"),onClickFunction:n.onAnotherAccountOptionsLinkClicked},{$link:t("#RemoveConnectionLink"),onClickFunction:n.onRemoveConnectionLinkClicked},{$link:t("#EmailOnlyLink"),onClickFunction:n.onEmailOnlyLinkClicked}],t.each(i,function(i,r){if(r.$link.get(0)&&r.$link.hasClass("DisabledLink")){r.$link.removeClass("DisabledLink"),r.$link.off("click");r.$link.on("click",t.proxy(r.onClickFunction,n))}}),r=t(n.dialog.content()).find("#FolderOptionsSection input"),t.each(r,function(n,i){t(i).prop("disabled",!1)})},this.setKeydownEvent=function(){var n=this;t(window).on("keydown.importaccount",t.proxy(n.onKeyDown,n))},this.onKeyDown=function(n){var u=this,i,r;n.keyCode===13&&(i=t(":focus"),r=i.prop("tagName")==="INPUT"&&(i.prop("type")==="submit"||i.prop("type")==="button"),r||i.prop("tagName")==="BUTTON"||i.prop("tagName")==="A"||(u.dialog.getButton({buttonName:"action"}).click(),n.stopPropagation(),n.preventDefault()))},this.startOAuthImport=function(){var i=this,u=i.dialog.notificationArea(),r;u.hide(),r=t("<div><\/div>"),r.appendTo(".c-InboxFlowDialog"),n.SHbiFppLoader.loadFppRequest(r,"shbivalidateoauthimport",{},6e4).then(function(r,u){var s,e,o,f,h;if(u==null||u.length==0)throw new Error(0,"Invalid server result at ValidateOAuthImport request.");for(s=!1,e=0;e<u.length;e++)if(o=u[e],o&&o.type===HM.DLReturnType.SuccessBoolean){if(o.success){if(f=HM.SwitchFolderMappingOption.Root,t("#FolderOptionsSection").length>0)if(t("#existingFolderId").prop("checked"))f=HM.SwitchFolderMappingOption.Root;else if(t("#newFolderId").prop("checked"))f=HM.SwitchFolderMappingOption.Subfolder;else throw new Error(0,"Failed to get folder option.");else f=i.manifest.folderMappingOption;$Cookie.setSessionCookie("swfm",f),i.exitInfo=HM.SwitchExitInfo.ConnectAdd,$BSI.navigateTo(i.manifest.connectUrl)}else n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:HM.SwitchState.ImportGmail,SwEventInfo:"Import in progress"}),h=i.getNotificationContentForError(HM.ImportStartErrorType.ImportProcessIsRunning),i.showError(h),i.enableInputControls();s=!0;break}if(!s)throw new Error(0,"Invalid server result at ValidateOAuthImport request.");},function(t){n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,HM.SwitchState.ImportGmail);var r=i.getNotificationContentForError(HM.ImportStartErrorType.Other);i.showError(r),i.enableInputControls()})},this.logExitEvent=function(){var t=this;n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.ImportGmail,SwExitInfo:t.exitInfo}),t.exitInfo===HM.SwitchExitInfo.ConnectAdd?n.ImportAccountInstrumentationHelper.savePreviousState(HM.SwitchState.ConnectAdd):t.exitInfo===HM.SwitchExitInfo.ConnectEdit&&n.ImportAccountInstrumentationHelper.savePreviousState(HM.SwitchState.ConnectEdit)},this.cleanupEventHandlers=function(){var i=this;t(i.dialog).unbind("buttonclick.dialog"),t(i.dialog).unbind("beforedismiss"),t(window).off("beforeunload.importaccount"),t(window).off("keydown.importaccount"),n.Cmd("openinboxflowfolderoptions").unsubscribeAll(),n.Cmd("openinboxflowanotheraccountoptions").unsubscribeAll(),n.Cmd("removecurrentconnection").unsubscribeAll(),n.Cmd("openemailonlydialog").unsubscribeAll(),n.Cmd("startoauthimport").unsubscribeAll()},this.onBeforeUnload=function(){var n=this;n.logExitEvent(),n.cleanupEventHandlers()}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="inboxFlowImapImportTemplate",r=n.getContextObject,u=n.ImapImportDialogsManager=function(u){function lt(){if(e=t(o.content()),f.manifest.isAdvancedOptionsEnabled)e.find(".imapImportAdvancedLink").on("click",t.proxy(f.onAdvancedClick,f));e.find(".imapImportPrivacyLink").on("click",t.proxy(f.onPrivacyClick,f));e.find(".importPopSuggestLink").on("click",t.proxy(f.onPopSuggestClick,f));setTimeout(function(){e.find("#imapImportEmailAddress:visible").focus()},30),w=o.getButton({buttonName:"action"});t(window).on("keydown.importaccount",t.proxy(f.onKeydown,f));t(window).on("unload.importaccount",at);n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.ImportImapBasic})}function tt(t){if(f._maybeSaveAddressAndPassword(),a="advanced",y=HM.SmtpSetupResult.NotSet,e.find(".imapImportBasic").hide(),e.find(".imapImportBasic").addClass("NoDisplay"),e.find(".popSuggestion").addClass("NoDisplay"),e.find(".popSuggestion").hide(),e.find(".UserTitle").text(g),e.find(".imapImportAdvanced").removeClass("NoDisplay"),e.find(".imapImportAdvanced").show(),yt(),t&&t!=""){var i=e.find("#captionTextAdvanced");i.html(t),i.show()}w.text(n.GetString("InboxFlow.ImapImport.Button.Import")),o.reposition(),e.find("#imapImportEmailAddress:visible").focus(),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.ImportImapAdvanced})}function ft(t){var i;f._maybeSaveAddressAndPassword(),i=t&&t!=""?n.GetString("InboxFlow.ImapImport.PopSuggestion.Description.TextFormat").format(t):n.GetString("InboxFlow.ImapImport.PopSuggestion.Description"),a="popsuggest",e.find(".imapImportBasic").hide(),e.find(".imapImportAdvanced").hide(),e.find(".UserTitle").text(n.GetString("InboxFlow.ImapImport.PopSuggestion.Title")),e.find(".popSuggestion").find(".descriptionText").text(i),e.find(".popSuggestion").show(),e.find(".popSuggestion").removeClass("NoDisplay"),w.text(n.GetString("InboxFlow.ImapImport.Button.Next")),o.reposition(),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.PopSuggestion})}function it(i,r,u){if(u==="action"){if(a==="basic")n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportImapBasic,SwSelectInfo:HM.SwitchSelectInfo.Next}),wt()&&f.validateJobStatusAndStartImport();else if(a==="advanced")n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportImapAdvanced,SwSelectInfo:HM.SwitchSelectInfo.Next}),f.validateJobStatusAndStartImport();else if(a==="popsuggest"){var o=e.find('input[name="popSuggestOptions"]:checked').val();o==="mmt"?(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.PopSuggestion,SwSelectInfo:HM.SwitchSelectInfo.Mmt}),b=HM.SwitchExitInfo.ImportClients,$BSI.navigateTo(f.manifest.mailMigrationUrl)):o==="popagg"?(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.PopSuggestion,SwSelectInfo:HM.SwitchSelectInfo.Pop}),b=HM.SwitchExitInfo.PopAgg,HM.StampCookieForHbi(!0,function(){var u=n.config.LiveViewsConfig.canaryTokenName,e=$Network.getCookie(u),o=s,i=l,r=t("<form>",{action:f.manifest.popAggUrl,target:"_top",method:"post"}),e=t("<input>",{name:u,id:u,type:"hidden",value:e}),h;r.append(e),o&&(h=t("<input>",{name:"AddressInput",id:"AddressInput",type:"hidden",value:o}),r.append(h)),i&&(i=t("<input>",{name:"PasswordInput",id:"PasswordInput",type:"hidden",value:i}),r.append(i)),t("body").append(r),r.submit()},{},function(){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:h(),SwEventInfo:"Failed Hbi cookie stamp"}),$BSI.navigateTo(f.manifest.popAggUrl)})):o==="imap"&&(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.PopSuggestion,SwSelectInfo:HM.SwitchSelectInfo.Options}),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.PopSuggestion,SwExitInfo:HM.SwitchExitInfo.ImportImapAdvanced}),tt(null))}}else n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:h(),SwSelectInfo:HM.SwitchSelectInfo.Close}),st(),n.ImportAccountInstrumentationHelper.maybeLogEnterImportTopAction()}function et(){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:h(),SwExitInfo:b})}function ot(){et(),t(o).off("unload.importaccount")}function at(){et(),t(o).off("unload.importaccount")}function st(){f.manifest.isAdvancedOptionsEnabled&&e.find(".imapImportAdvancedLink").off("click",f.onAdvancedClick),e.find(".imapImportPrivacyLink").off("click",f.onPrivacyClick),e.find(".importPopSuggestLink").off("click",f.onPopSuggestClick),t(o).off("buttonclick",it),t(o).off("beforedismiss",ot),t(window).off("keydown.importaccount",f.onKeydown),o.dismiss(),e=null,o=null}function vt(){return t.templates(null,{markup:"#"+i,converters:{isChecked:function(n){return n?"checked":""}}})}function yt(){if(s!=null){e.find("#imapImportEmailAddress:visible").val(s);var i=e.find("#imapImportServerName").val(),t=pt(s);(!i||i=="")&&t&&t!=""&&e.find("#imapImportServerName").val(n.GetString("InboxFlow.ImapImport.ServerPrefix")+"."+t)}l!=null&&e.find("#imapImportPassword:visible").val(l),k!=null?e.find("#imapImportUserName").val(k):s!=null&&e.find("#imapImportUserName").val(s)}function pt(n){var t=n.split("@");return t.length>0?t[t.length-1]:null}function wt(){var i,t,r;return s=e.find("#imapImportEmailAddress:visible").val(),l=e.find("#imapImportPassword:visible").val(),i=!1,s!=null&&s!=""&&n.String.isValidEmailSyntax(s)||(t=e.find("#errorOnAddress"),r=n.GetString("InboxFlow.ImapImport.Error.Client.AddressFormat"),t.html(r),t.show(),i=!0,n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:h(),SwEventInfo:"Invalid address"})),(l==null||l=="")&&(t=e.find("#errorOnPassword"),r=n.GetString("InboxFlow.ImapImport.Error.Client.Password"),t.html(r),t.show(),i=!0,n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:h(),SwEventInfo:"Invalid password"})),i&&o.reposition(),!i}function c(i){var r=o.notificationArea(),u;i?(e.find(".inlineError").hide(),rt(),d=!0,w.prop("disabled",!0),u=t($f.createLoading({text:n.GetString("InboxFlow.ImapImport.InProgress")})),r.show(),r.append(u)):(d=!1,w.prop("disabled",!1),r.hide(),r.empty())}function p(n){var i=o.notificationArea(),r=t("<span><\/span>").addClass("c-InboxFlowDialog").append(n.addClass("ErrorMessage"));i.html(r),i.show(),o.reposition()}function rt(){var n=o.notificationArea();n.empty(),n.css("width","auto"),n.hide(),o.reposition()}function v(){ht=!0;var i=t("<span>"+n.GetString("InboxFlow.ImapImport.Error.TryLater")+"<\/span>");p(i)}function h(){var n=HM.SwitchState.Unknown;if(a==="basic")n=HM.SwitchState.ImportImapBasic;else if(a==="advanced")n=HM.SwitchState.ImportImapAdvanced;else if(a==="popsuggest")n=HM.SwitchState.PopSuggestion;else throw new Error(0,"Unexpected dialog state: "+a.toString());return n}var y;this.manifest=u;var f=this,o=null,e=null,w=null,a=null,d=!1,ht=!1,b=HM.SwitchExitInfo.NotApplicable,g=null,s=null,l=null,k=null,bt=t("BODY"),ut=12e4,nt=6e4,ct=13;f.accountSettings=null,y=HM.SmtpSetupResult.NotSet,f.initializeNotification=function(){var i=f.manifest.isForceImapImportEnabled,e={IsForceImapImportEnabled:i,ShowAdvancedDialog:f.manifest.showAdvancedDialog,IsClientImportEnabled:f.manifest.isClientImportEnabled,IsOutlookSupported:f.manifest.isOutlookSupported,IsAdvancedOptionsEnabled:f.manifest.isAdvancedOptionsEnabled,MaxInputLength:f.manifest.maxInputLength},u;g=i?n.GetString("InboxFlow.ImapImport.Title.Gmail"):n.GetString("InboxFlow.ImapImport.Title"),u="<div id='ImapImportDialog'>"+vt().render(e,r())+"<\/div>",o=wLive.Controls.Notifications.createModalDialog({title:g,content:u,buttons:{action:n.GetString("InboxFlow.ImapImport.Button.Import"),close:n.GetString("InboxFlow.ImapImport.Button.Cancel")},options:{dismissOnButtonClick:!1}}),a=f.manifest.showAdvancedDialog?"advanced":"basic";t(o).on("buttonclick",t.proxy(it,f));t(o).on("aftershow",t.proxy(lt,f));t(o).on("beforedismiss",t.proxy(ot,f));wLive.Controls.Notifications.getQueue().start()},f.showNotification=function(){o.show()},f.onAdvancedClick=function(t){return n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportImapBasic,SwSelectInfo:HM.SwitchSelectInfo.Options}),d||(e.find(".inlineError").hide(),rt(),s=e.find("#imapImportEmailAddress:visible").val(),l=e.find("#imapImportPassword:visible").val(),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.ImportImapBasic,SwExitInfo:HM.SwitchExitInfo.ImportImapAdvanced}),tt(null)),t.preventDefault(),!1},f.onPrivacyClick=function(t){return n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:h(),SwSelectInfo:HM.SwitchSelectInfo.External}),$BSI.navigateTo(f.manifest.privacyLinkUrl,"_blank"),t.preventDefault(),!1},f.onPopSuggestClick=function(t){return n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.ImportImapAdvanced,SwSelectInfo:HM.SwitchSelectInfo.Pop}),d||(e.find(".inlineError").hide(),rt(),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:h(),SwExitInfo:HM.SwitchExitInfo.PopSuggestion}),ft()),t.preventDefault(),!1},f.onKeydown=function(n){var u=n.which,i,r;u===ct&&o&&(i=t(":focus"),r=i.prop("tagName")==="INPUT"&&(i.prop("type")==="submit"||i.prop("type")==="button"),r||i.prop("tagName")==="BUTTON"||i.prop("tagName")==="A"||i.prop("tagName")==="SELECT"||i.prop("tagName")==="OPTION"||it({},{},"action"))},f.validateJobStatusAndStartImport=function(){c(!0);var i=t("<div><\/div>");i.appendTo("#ImapImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbivalidateimportstart",{},nt).then(function(i,r){var s,u,e,l;if(o){if(c(!1),r==null||r.length==0)throw new Error(0,"Invalid server result at ValidateImportStart request.");for(s=!1,u=0;u<r.length;u++)if(e=r[u],e&&e.type===HM.DLReturnType.SuccessBoolean){e.success?a==="basic"?f.startDetectImapAndSmtp():f.verifyImapSettings():(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:h(),SwEventInfo:"Import in progress"}),l=t("<span><\/span>").text(n.GetString("InboxFlow.ImapImport.Error.ImportRunning")),p(l)),s=!0;break}if(!s){v("Invalid server result at ValidateImportStart request.");throw new Error(0,"Invalid server result at ValidateImportStart request.");}}},function(t){(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,h()),o)&&(c(!1),v("SHbiValidateImportStart failed"))})},f.startDetectImapAndSmtp=function(){c(!0);var i=t("<div><\/div>");i.appendTo("#ImapImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbidetectimapandsmtpmailsettingsforswitch",{accountAddress:s,accountPassword:l,isYahoo:!1},ut).then(function(i,r){var a,l,u,w,s;if(o){if(c(!1),r==null||r.length==0){a="shbidetectimapandsmtpmailsettings request failure - no server result.",v(a);throw new Error(0,a);}if(l=r[0],l===HM.SettingsVerificationStatus.Success)f.accountSettings=r[2],f.accountSettings.SmtpDetectOrSetupResult===HM.SmtpSetupResult.Success&&f.accountSettings.SmtpServerAddress&&f.accountSettings.SmtpServerAddress!=""?f.storeSmtpSettings():(y=f.accountSettings.SmtpDetectOrSetupResult===HM.SmtpSetupResult.Skipped?HM.SmtpSetupResult.Skipped:HM.SmtpSetupResult.Failure,y===HM.SmtpSetupResult.Failure&&n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:h(),SwEventInfo:"No SMTP send"}),f.startImapImport());else if(u=r[1],u&&u!="")if(l===HM.SettingsVerificationStatus.FailedImapAuthentication){if(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:HM.SwitchState.ImportImapBasic,SwEventInfo:"Auth failure"}),s=t("<div>"+u+"<\/div>"),f.manifest.isAdvancedOptionsEnabled)s.find("A").on("click",f.onAdvancedClick);p(s)}else l===HM.SettingsVerificationStatus.FailedImapConnection?(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:HM.SwitchState.ImportImapBasic,SwEventInfo:"Connection failure"}),f.manifest.isAdvancedOptionsEnabled?(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.ImportImapBasic,SwExitInfo:HM.SwitchExitInfo.ImportImapAdvanced}),tt(u)):(w=e.find("#errorOnAddress"),w.html(u),w.show())):(s=t("<span>"+u+"<\/span>"),p(s))}},function(t,i){var u,r,a,l;if(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,h()),o){if(c(!1),i!=null&&i.length>0)for(u=0;u<i.length;u++)if(r=i[u],r&&(r.type===HM.DLReturnType.FppError||r.type===HM.DLReturnType.FppErrorUi)&&(a=parseInt(r.type===HM.DLReturnType.FppError?r.fppError.Error.ErrorCode:r.fppError.Error.errorCode,16),a===HM.MailErrorExport.ImportAccount_ImportNotAllowed)){f.manifest.isClientImportEnabled&&f.manifest.isPopAggEnabled?ft(s):(l=e.find("#errorOnAddress"),l.text(n.GetString("InboxFlow.ImapImport.Error.ImapNotSupported.TextFormat").format(s)),l.show());return}v("shbidetectimapandsmtpmailsettings failed");throw new Error(0,"shbidetectimapandsmtpmailsettings request failure");}})},f._maybeSaveAddressAndPassword=function(){var t=e.find("#imapImportEmailAddress:visible"),n;t!=null&&t.length>0&&(s=t.val()),n=e.find("#imapImportPassword:visible"),n!=null&&n.length>0&&(l=n.val())},f.verifyImapSettings=function(){var i;c(!0),f._maybeSaveAddressAndPassword(),k=e.find("#imapImportUserName").val();var r=e.find("#imapImportServerName").val(),u=e.find("#imapImportServerPort").val(),a=e.find("#imapImportSecureConnection").prop("checked");f.accountSettings={ImapServerAddress:r,ImapServerPort:u,IsImapOverSsl:a},y=HM.SmtpSetupResult.NotSet,i=t("<div><\/div>"),i.appendTo("#ImapImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbiverifyimapsettings",{accountAddress:s,accountPassword:l,imapUserName:k,serverAddress:r,serverPort:u,isSsl:a},ut).then(function(i,r){var s,h,e,u;if(o){if(c(!1),r==null||r.length==0){u="shbiverifyimapsettings request failure - no server result.",v(u);throw new Error(0,u);}if(s=r[0],s===HM.SettingsVerificationStatus.Success)f.startImapImport();else if(h=r[1],e=t("<span>"+h+"<\/span>"),s===HM.SettingsVerificationStatus.FailedImapAuthentication)n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:HM.SwitchState.ImportImapAdvanced,SwEventInfo:"Auth failure"}),p(e);else if(s===HM.SettingsVerificationStatus.FailedImapConnection){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:HM.SwitchState.ImportImapAdvanced,SwEventInfo:"Connection failure"});e.find("A").on("click",f.onPopSuggestClick);p(e)}else if(s===HM.SettingsVerificationStatus.NotSet){e.find("A").on("click",f.onPopSuggestClick);p(e)}else{u="shbiverifyimapsettings request failure - unexpected error code.",v(u);throw new Error(0,u);}}},function(t){if(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,h()),o){f.accountSettings=null,c(!1);var i="shbiverifyimapsettings request failure";v(i);throw new Error(0,i);}})},f.storeSmtpSettings=function(){var u,i,r;if(f.accountSettings!=null)u=f.accountSettings.SmtpUserName&&f.accountSettings.SmtpUserName.length>0?f.accountSettings.SmtpUserName.toString():"",c(!0),i=t("<div><\/div>"),i.appendTo("#ImapImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbistoresmtpsettings",{accountAddress:s,encryptedUserName:u,accountPassword:l,serverAddress:f.accountSettings.SmtpServerAddress,serverPort:f.accountSettings.SmtpServerPort,secureType:f.accountSettings.SmtpSecureType},nt).then(function(n,t){var i,r;if(o){if(t==null||t.length==0){i="storeSmtpSettings request failure - no server result.",v(i);throw new Error(0,i);}r=t[0],y=r===HM.SettingsVerificationStatus.Success?HM.SmtpSetupResult.Success:HM.SmtpSetupResult.Failure}},function(t){(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,h()),o)&&(y=HM.SmtpSetupResult.Failure)}).always(function(){c(!1),f.startImapImport()});else{r="storeSmtpSettings request failure - no setting found.",v(r);throw new Error(0,r);}},f.startImapImport=function(){if(f.accountSettings!=null){c(!0);var r=f.accountSettings.ImapUserName&&f.accountSettings.ImapUserName.length>0?f.accountSettings.ImapUserName.toString():"",i=t("<div><\/div>");i.appendTo("#ImapImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbistartimapimport",{accountAddress:s,encryptedUserName:r,imapUserName:k||"",accountPassword:l,serverAddress:f.accountSettings.ImapServerAddress,serverPort:f.accountSettings.ImapServerPort,isSsl:f.accountSettings.IsImapOverSsl,smtpResult:y},nt).then(function(){o&&f.showCongratsDialog()},function(t){if(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,h()),o){c(!1);var i="shbistartimapimport request failure";v(i);throw new Error(0,i);}})}},f.showCongratsDialog=function(){var t=new Date,i;$Cookie.setCookie(f.manifest.importIsRunningCookieName,"1",n.config.cookies.cookieDomain,0,new Date(t.getFullYear()+1,t.getMonth(),t.getDay()),1),$Cookie.setCookie(f.manifest.importHasRunCookieName,"1",n.config.cookies.cookieDomain,0,new Date(t.getFullYear()+1,t.getMonth(),t.getDay()),1),f.manifest.completeUrl!=null&&f.manifest.completeUrl.length>0?($Cookie.setSessionCookie("sws","1"),b=HM.SwitchExitInfo.Congrats,$BSI.navigateTo(f.manifest.completeUrl)):(i=n.Dispatcher.fireCmd("hbigetcongratsdialogmanifest",{}),i.deferred.then(function(t,i){if(i==null||i.length!==1)throw new Error(0,"Invalid server result at HbiGetCongratsDialogManifest request.");b=HM.SwitchExitInfo.Congrats,st();var u=i[0],r=new n.inboxFlow.ImportAccountCongratsDialogsManager(u);r.initializeNotification(),r.showNotification(),n.inboxFlow.importProgressIndicator=new n.inboxFlow.importProgressIndicatorManager(f.manifest.indicatorManifest),n.inboxFlow.importProgressIndicator.initializeNotification(),n.inboxFlow.importProgressIndicator.showNotification()},function(t){n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,h())}))}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="inboxFlowYahooImportTemplate",r=n.getContextObject,u=n.yahooImportDialogsManager=function(u){function ut(){s=t(e.content());s.find(".yahooImportPrivacyLink").on("click",t.proxy(f.onPrivacyClick,f));s.find(".yahooImportOptionsLink").on("click",t.proxy(f.onFolderOptionsLinkClicked,f));n.setFocus(function(){s.find("#yahooImportEmailAddress:visible").focus()}),p=e.getButton({buttonName:"action"});t(window).on("keydown.importaccount",t.proxy(f.onKeydown,f));t(window).on("unload.importaccount",ft);n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:o()})}function k(t,i,r){r==="action"?(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:o(),SwSelectInfo:HM.SwitchSelectInfo.Next}),ot()&&f.validateJobStatusAndStartImport()):(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:o(),SwSelectInfo:HM.SwitchSelectInfo.Close}),nt(),n.ImportAccountInstrumentationHelper.maybeLogEnterImportTopAction())}function d(){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:o(),SwExitInfo:w})}function g(){d(),t(e).off("unload.importaccount")}function ft(){d(),t(e).off("unload.importaccount")}function nt(){s.find(".yahooImportPrivacyLink").off("click",f.onPrivacyClick),s.find(".yahooImportOptionsLink").off("click",f.onFolderOptionsLinkClicked),t(e).off("buttonclick",k),t(e).off("beforedismiss",g),t(window).off("keydown.importaccount",f.onKeydown),e.dismiss(),s=null,e=null}function et(){return t.templates(null,{markup:"#"+i})}function ot(){c=s.find("#yahooImportEmailAddress:visible").val(),v=s.find("#yahooImportPassword:visible").val();var t,i,r;return t=s.find("#errorOnAddress"),c!=null&&c!=""&&n.String.isValidEmailSyntax(c)?(t=s.find("#errorOnAddress"),t&&(t.html(""),t.addClass("NoDisplay"))):(i=n.GetString("InboxFlow.YahooImport.Error.Client.AddressFormat"),r=!0,t.html(i),t.removeClass("NoDisplay"),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:o(),SwEventInfo:"Invalid address"})),t=s.find("#errorOnPassword"),v==null||v==""?(i=n.GetString("InboxFlow.YahooImport.Error.Client.Password"),r=!0,t.html(i),t.removeClass("NoDisplay"),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:o(),SwEventInfo:"Invalid password"})):t&&(t.html(""),t.addClass("NoDisplay")),r&&(tt(),e.reposition()),!r}function h(i){var r=e.notificationArea(),u;i?(s.find(".inlineError").addClass("NoDisplay"),tt(),p.prop("disabled",!0),u=t($f.createLoading({text:n.GetString("InboxFlow.YahooImport.InProgress")})),r.show(),r.removeClass("NoDisplay"),r.append(u)):(p.prop("disabled",!1),r.addClass("NoDisplay"),r.empty())}function y(n){var i=e.notificationArea(),r=t("<span><\/span>").addClass("c-InboxFlowDialog").append(n.addClass("ErrorMessage"));i.html(r),i.removeClass("NoDisplay"),e.reposition()}function tt(){var n=e.notificationArea();n.empty(),n.css("width","auto"),n.addClass("NoDisplay"),e.reposition()}function a(){var i=t("<span>"+n.GetString("InboxFlow.YahooImport.Error.TryLater")+"<\/span>");y(i)}function o(){return HM.SwitchState.ImportYahoo}var f=this,l;f.manifest=u;var e=null,s=null,p=null,w=HM.SwitchExitInfo.NotApplicable,c=null,v=null,it=12e4,b=6e4,rt=13;f.accountSettings=null,l=HM.SmtpSetupResult.NotSet,f.initializeNotification=function(){var i={IsAccountConnected:f.manifest.isAccountConnected,IsAdvancedOptionsEnabled:f.manifest.isAdvancedOptionsEnabled,MaxInputLength:f.manifest.maxInputLength},u="<div id='YahooImportDialog'>"+et().render(i,r())+"<\/div>";e=wLive.Controls.Notifications.createModalDialog({title:n.GetString("InboxFlow.YahooImport.NotConnected.Title"),content:u,buttons:{action:n.GetString("InboxFlow.YahooImport.Button.Import"),close:n.GetString("InboxFlow.YahooImport.Button.Cancel")},options:{dismissOnButtonClick:!1}});t(e).on("buttonclick",t.proxy(k,f));t(e).on("aftershow",t.proxy(ut,f));t(e).on("beforedismiss",t.proxy(g,f));wLive.Controls.Notifications.getQueue().start()},f.showNotification=function(){e.show()},f.onFolderOptionsLinkClicked=function(i){return n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:o(),SwSelectInfo:HM.SwitchSelectInfo.Options}),t(".yahooImportOptionsLink").addClass("NoDisplay"),t(".FolderOptionsSection").removeClass("NoDisplay"),i.preventDefault(),!1},f.onPrivacyClick=function(t){return n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:o(),SwSelectInfo:HM.SwitchSelectInfo.External}),$BSI.navigateTo(f.manifest.privacyLinkUrl,"_blank"),t.preventDefault(),!1},f.onKeydown=function(n){var u=n.which,i,r;u===rt&&e&&(i=t(":focus"),r=i.prop("tagName")==="INPUT"&&(i.prop("type")==="submit"||i.prop("type")==="button"),r||i.prop("tagName")==="BUTTON"||i.prop("tagName")==="A"||i.prop("tagName")==="SELECT"||i.prop("tagName")==="OPTION"||k({},{},"action"))},f.validateJobStatusAndStartImport=function(){h(!0);var i=t("<div><\/div>");i.appendTo("#YahooImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbivalidateimportstart",{},b).then(function(i,r){var c,u,s,l;if(e){if(h(!1),r==null||r.length==0)throw new Error(0,"Invalid server result at ValidateImportStart request.");for(c=!1,u=0;u<r.length;u++)if(s=r[u],s&&s.type===HM.DLReturnType.SuccessBoolean){s.success?f.startDetectImapAndSmtp():(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:o(),SwEventInfo:"Import in progress"}),l=t("<span><\/span>").text(n.GetString("InboxFlow.ImapImport.Error.ImportRunning")),y(l)),c=!0;break}if(!c){a("Invalid server result at ValidateImportStart request.");throw new Error(0,"Invalid server result at ValidateImportStart request.");}}},function(t){(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,o()),$Cookie.deleteCookie("swt"),e)&&(h(!1),a("SHbiValidateImportStart failed"))})},f.startDetectImapAndSmtp=function(){h(!0);var i=t("<div><\/div>");i.appendTo("#YahooImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbidetectimapandsmtpmailsettingsforswitch",{accountAddress:c,accountPassword:v,isYahoo:!0},it).then(function(i,r){var v,c,u,p,w;if(e){if(h(!1),r==null||r.length==0){$Cookie.deleteCookie("swt"),v="shbidetectimapandsmtpmailsettings request failure - no server result.",a(v);throw new Error(0,v);}c=r[0],c===HM.SettingsVerificationStatus.Success?(f.accountSettings=r[2],f.accountSettings.SmtpDetectOrSetupResult===HM.SmtpSetupResult.Success&&f.accountSettings.SmtpServerAddress&&f.accountSettings.SmtpServerAddress!=""?f.storeSmtpSettings():(l=f.accountSettings.SmtpDetectOrSetupResult===HM.SmtpSetupResult.Skipped?HM.SmtpSetupResult.Skipped:HM.SmtpSetupResult.Failure,l===HM.SmtpSetupResult.Failure&&n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:o(),SwEventInfo:"No SMTP send"}),f.startYahooImport())):(u=r[1],u&&u!=""&&($Cookie.deleteCookie("swt"),c===HM.SettingsVerificationStatus.FailedImapAuthentication?(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:o(),SwEventInfo:"Auth failure"}),y(t("<div>"+u+"<\/div>"))):c===HM.SettingsVerificationStatus.FailedImapConnection?(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Error,SwState:o(),SwEventInfo:"Connection failure"}),p=s.find("#errorOnAddress"),p.html(u),p.removeClass("NoDisplay")):(w=t("<span>"+u+"<\/span>"),y(w))))}},function(t,i){var u,r,l,f;if(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,o()),$Cookie.deleteCookie("swt"),e){if(h(!1),i!=null&&i.length>0)for(u=0;u<i.length;u++)if(r=i[u],r&&(r.type===HM.DLReturnType.FppError||r.type===HM.DLReturnType.FppErrorUi)){l=parseInt(r.type===HM.DLReturnType.FppError?r.fppError.Error.ErrorCode:r.fppError.Error.errorCode,16),l===HM.MailErrorExport.ImportAccount_ImportNotAllowed&&(f=s.find("#errorOnAddress"),f.text(n.GetString("InboxFlow.ImapImport.Error.ImapNotSupported.TextFormat").format(c)),f.show());return}a("shbidetectimapandsmtpmailsettings failed");throw new Error(0,"shbidetectimapandsmtpmailsettings request failure");}})},f.storeSmtpSettings=function(){var u,i,r;if(f.accountSettings!=null)u=f.accountSettings.SmtpUserName&&f.accountSettings.SmtpUserName.length>0?f.accountSettings.SmtpUserName.toString():"",h(!0),i=t("<div><\/div>"),i.appendTo("#YahooImportDialog"),n.SHbiFppLoader.loadFppRequest(i,"shbistoresmtpsettings",{accountAddress:c,encryptedUserName:u,accountPassword:v,serverAddress:f.accountSettings.SmtpServerAddress,serverPort:f.accountSettings.SmtpServerPort,secureType:f.accountSettings.SmtpSecureType},b).then(function(n,t){var i,r;if(e){if(t==null||t.length==0){i="storeSmtpSettings request failure - no server result.",a(i);throw new Error(0,i);}r=t[0],l=r===HM.SettingsVerificationStatus.Success?HM.SmtpSetupResult.Success:HM.SmtpSetupResult.Failure}},function(t){(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,o()),$Cookie.deleteCookie("swt"),e)&&(l=HM.SmtpSetupResult.Failure)}).always(function(){h(!1),f.startYahooImport()});else{r="storeSmtpSettings request failure - no setting found.",a(r);throw new Error(0,r);}},f.startYahooImport=function(){var u,i,r;if(f.accountSettings!=null){if(h(!0),u=f.accountSettings.ImapUserName&&f.accountSettings.ImapUserName.length>0?f.accountSettings.ImapUserName.toString():"",i=HM.SwitchFolderMappingOption.Root,t(".FolderOptionsSection").length>0)if(t("#existingFolderId").prop("checked"))i=HM.SwitchFolderMappingOption.Root;else if(t("#newFolderId").prop("checked"))i=HM.SwitchFolderMappingOption.Subfolder;else throw new Error(0,"Failed to get folder option.");else i=f.manifest.folderMappingOption;$Cookie.setSessionCookie(f.manifest.folderMappingCookieName,i),r=t("<div><\/div>"),r.appendTo("#YahooImportDialog"),n.SHbiFppLoader.loadFppRequest(r,"shbistartimapimport",{accountAddress:c,encryptedUserName:u,imapUserName:"",accountPassword:v,serverAddress:f.accountSettings.ImapServerAddress,serverPort:f.accountSettings.ImapServerPort,isSsl:f.accountSettings.IsImapOverSsl,smtpResult:l},b).then(function(){e&&f.showCongratsDialog()},function(t){if(n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,o()),$Cookie.deleteCookie("swt"),e){h(!1);a("shbistartimapimport request failure")}})}},f.showCongratsDialog=function(){var t=new Date,i;$Cookie.setCookie(f.manifest.importIsRunningCookieName,"1",n.config.cookies.cookieDomain,0,new Date(t.getFullYear()+1,t.getMonth(),t.getDay()),1),$Cookie.setCookie(f.manifest.importHasRunCookieName,"1",n.config.cookies.cookieDomain,0,new Date(t.getFullYear()+1,t.getMonth(),t.getDay()),1),f.manifest.completeUrl!=null&&f.manifest.completeUrl.length>0?($Cookie.setSessionCookie("sws","1"),w=HM.SwitchExitInfo.Congrats,$BSI.navigateTo(f.manifest.completeUrl)):(i=n.Dispatcher.fireCmd("hbigetcongratsdialogmanifest",{}),i.deferred.then(function(t,i){if(i==null||i.length!==1)throw new Error(0,"Invalid server result at HbiGetCongratsDialogManifest request.");w=HM.SwitchExitInfo.Congrats,nt();var u=i[0],r=new n.inboxFlow.ImportAccountCongratsDialogsManager(u);r.initializeNotification(),r.showNotification(),n.inboxFlow.importProgressIndicator=new n.inboxFlow.importProgressIndicatorManager(f.manifest.indicatorManifest),n.inboxFlow.importProgressIndicator.initializeNotification(),n.inboxFlow.importProgressIndicator.showNotification()},function(t){n.ImportAccountInstrumentationHelper.maybeLogFppTimeout(t,o()),$Cookie.deleteCookie("swt")}))}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.inboxFlow=n.inboxFlow||{},r=i.ImportAccountCongratsDialogsManager=function(i){function u(){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.CongratsPopup})}var r=this;r.dialog=null,r.manifest=i,r.enterInfo=HM.SwitchEnterInfo.NotApplicable,r.initializeNotification=function(){var l=r.manifest.canReceiveEmail,a=r.manifest.supportAutoForwarding,p=r.manifest.isGoogle,w=r.manifest.isYahoo,b=r.manifest.showDefaultCongrats,v=r.manifest.isRetry,e=r.manifest.importedAddress,k=r.manifest.autoForwardingHelpUrl,s="",o=t("<div />"),h={},c=function(){throw new Error(0,"Not implemented");},i,f,y;if(p&&l&&a&&!v)r.enterInfo=HM.SwitchEnterInfo.GmailAutoForwarding,s=n.GetString("InboxFlow.ImportAccountCongratsDialog.SetupForwardingFromGmail.Title"),h={action:n.GetString("InboxFlow.ImportAccountCongratsDialog.OpenGmailButton.Label"),close:n.GetString("InboxFlow.ImportAccountCongratsDialog.LaterButton.Label")},i={description:n.GetString("InboxFlow.ImportAccountCongratsDialog.DescriptionWithEmailAddress.TextFormat").format(e)},f=t.templates("#SetupForwardingDialogForGmailTemplate"),o.html(f.render(i,n.getContextObject())),c=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.CongratsPopup,SwSelectInfo:HM.SwitchSelectInfo.Gmail}),n.Cmd("opengmailpage").fire({e:t.originalEvent}),t.preventDefault()};else if(w&&l&&!b)r.enterInfo=HM.SwitchEnterInfo.YahooAutoForwarding,s=n.GetString("InboxFlow.ImportAccountCongratsDialog.SetupForwardingFromYahoo.Title"),h={action:n.GetString("InboxFlow.ImportAccountCongratsDialog.OpenHelpButton.Label"),close:n.GetString("InboxFlow.ImportAccountCongratsDialog.LaterButton.Label")},i={description:n.GetString("InboxFlow.ImportAccountCongratsDialog.SetupForwardingFromYahoo.Description.TextFormat").format(e),forwardingDescription:n.GetString("InboxFlow.ImportAccountCongratsDialog.SetupForwardingFromYahoo.ForwardingDescription.TextFormat")},f=t.templates("#SetupForwardingDialogForOtherProviderTemplate"),o.html(f.render(i,n.getContextObject())),c=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.CongratsPopup,SwSelectInfo:HM.SwitchSelectInfo.Yahoo}),n.Cmd("openyahoopage").fire({e:t.originalEvent}),t.preventDefault()};else if(l&&a&&!v)r.enterInfo=HM.SwitchEnterInfo.OtherAutoForwarding,s=n.GetString("InboxFlow.ImportAccountCongratsDialog.SetupForwardingFromOtherProvider.Title").format(e.encodeHtml()),h={action:n.GetString("InboxFlow.ImportAccountCongratsDialog.OpenHelpButton.Label"),close:n.GetString("InboxFlow.ImportAccountCongratsDialog.LaterButton.Label")},i={description:n.GetString("InboxFlow.ImportAccountCongratsDialog.DescriptionWithEmailAddress.TextFormat").format(e),forwardingDescription:n.GetString("InboxFlow.ImportAccountCongratsDialog.SetupForwardingFromOtherProvider.ForwardingDescription.TextFormat").format(e)},f=t.templates("#SetupForwardingDialogForOtherProviderTemplate"),o.html(f.render(i,n.getContextObject())),c=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.CongratsPopup,SwSelectInfo:HM.SwitchSelectInfo.External}),n.Cmd("openhelppage").fire({e:t.originalEvent}),t.preventDefault()};else{r.enterInfo=HM.SwitchEnterInfo.NoAutoForwarding,s=n.GetString("InboxFlow.ImportAccountCongratsDialog.DefaultDialog.Title").format(e.encodeHtml()),h={close:n.GetString("InboxFlow.ImportAccountCongratsDialog.CloseButton.Label")},i={helpLink:n.GetString("InboxFlow.ImportAccountCongratsDialog.DefaultDialog.HelpLink.TextFormat").format(e.encodeHtml(),"OpenHelpLink","#")},f=t.templates("#ImportAccountDefaultCongratsDialogTemplate"),o.html(f.render(i,n.getContextObject())),y=t(o.find("#OpenHelpLink").get(0));y.on("click",t.proxy(r.onOpenHelpLinkClicked,r))}r.dialog=wLive.Controls.Notifications.createModalDialog({title:s,content:o,buttons:h}),t(r.dialog).bind({"buttonclick.dialog":function(t,i,u){u==="action"?c.call(r,t):u==="close"&&n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.CongratsPopup,SwSelectInfo:HM.SwitchSelectInfo.Close})},beforedismiss:function(){u(),t(r.dialog).unbind("buttonclick.dialog"),t(window).off("unload.importaccount")}})},r.showNotification=function(){n.Cmd("opengmailpage").subscribe(t.proxy(r.openGmailPage,r)),n.Cmd("openyahoopage").subscribe(t.proxy(r.openYahooHelpPage,r)),n.Cmd("openhelppage").subscribe(t.proxy(r.openHelpPage,r)),n.Cmd("openhelppagefromlink").subscribe(t.proxy(r.openHelpPage,r));t(r.dialog).on("aftershow",t.proxy(r.setKeydownEvent,r));t(window).on("unload.importaccount",t.proxy(r.onUnload,r));r.dialog.show(),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.CongratsPopup,SwEnterInfo:r.enterInfo})},r.onOpenHelpLinkClicked=function(t){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.CongratsPopup,SwSelectInfo:HM.SwitchSelectInfo.External}),n.Cmd("openhelppagefromlink").fire({e:t.originalEvent}),t.preventDefault()},r.openGmailPage=function(){$BSI.navigateTo(r.manifest.openGmailUrl,"_blank")},r.openHelpPage=function(){$BSI.navigateTo(r.manifest.autoForwardingHelpUrl,"_blank")},r.openYahooHelpPage=function(){$BSI.navigateTo(r.manifest.openYahooUrl,"_blank")},r.setKeydownEvent=function(){t(r.dialog.content()).on("keydown",t.proxy(r.clickDefaultButton,r))},r.clickDefaultButton=function(n){n.keyCode===13&&(r.dialog.getButton({buttonName:"action"}).get(0)?r.dialog.getButton({buttonName:"action"}).click():r.dialog.getButton({buttonName:"close"}).click(),n.stopPropagation(),n.preventDefault())},r.onUnload=function(){u(),t(window).off("unload.importaccount")}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.inboxFlow=n.inboxFlow||{},r=i.ImportAccountThrottlingDialogsManager=function(){function i(){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.CapacityLimit})}this.dialog=null,this.initializeNotification=function(){var r=this;r.dialog=wLive.Controls.Notifications.createModalDialog({title:n.GetString("InboxFlow.ImportAccountThrottling.Title"),content:n.GetString("InboxFlow.ImportAccountThrottling.Content"),buttons:{close:n.GetString("InboxFlow.ImportAccountThrottling.Button.OK")}}),t(r.dialog).bind({"buttonclick.dialog":function(t,i,r){if(r==="close")n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.CapacityLimit,SwSelectInfo:HM.SwitchSelectInfo.Close});else throw new Error(0,"Unexpected button name");},beforedismiss:function(){i(),t(window).off("unload.importaccount")}})},this.showNotification=function(){var i=this;i.dialog.show();t(window).on("unload.importaccount",t.proxy(i.onUnload,i));n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.CapacityLimit})},this.onUnload=function(){i(),t(window).off("unload.importaccount")}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function s(){return{alias:null,error:null,useNewFolder:!0,newFolder:null,existingFolder:null,folderPickerViewmodel:null,defaultFrom:!0,suggestDefaultFrom:!1}}var f=n.inboxFlow=n.inboxFlow||{},r=n.getContextObject,h=f.aliasCreateRuleDialogManager=function(u){function c(t,i,r){f.suggestDefaultFrom()&&(HM.ProcessPendingAlias(f.defaultFrom(),l),n.Cmd("instrument.aliasdefaultfrom").fire({defaultFrom:f.defaultFrom()})),r!=="action"||f.suggestDefaultFrom()&&f.defaultFrom()?s():v()}function l(t){var i=n.config.pageManager.manifests.Compose.initContext;t.defaultFromAddress&&(i.defaultFromAddress=t.defaultFromAddress),t.fromAddresses&&(i.fromAddresses=t.fromAddresses),n.Cmd("compose.updateusercomposedata").fire({userComposeData:t})}function a(t){return t.FolderType===HM.FolderType.USER_DEFINED||t.Id===n.config.sysFldrs.inboxFid}function v(){var t=f.useNewFolder()?null:f.existingFolder().id(),i;t===n.config.sysFldrs.inboxFid?s():(e.getButton({buttonName:"action"}).prop("disabled",!0),i=n.Dispatcher.fireCmd("createrecipientmoverule",{recipientEmail:f.alias(),folderId:t,folderName:t?null:f.newFolder()}),i.deferred.then(s,y))}function y(t){var i=t.errors[0],r,u,o;i&&i.Message?r=i.Message:(u=i&&i.type===HM.ErrorType.FolderError,o=u?n.vm.Container.GetErrorMessage(i):"Error.Global.InternalError",r=n.GetString(o)),f.error(r),e.getButton({buttonName:"action"}).prop("disabled",!1)}function s(){e.dismiss(),t.observable.simpleOff(f,"propertyChange"),e=f=null}function h(){return t.templates("#aliasCreateRuleTmpl")}var o=this,e=null,f=null;o.manifest=u,o.initializeNotification=function(){var u=new n.vm.ContainerList({title:"Folders",type:HM.ContainerType.Folders,rootContainer:new n.vm.Container({id:n.config.sysFldrs.noneFid,depth:0}),newItemLabel:null}),s=u.getContainerById(n.config.sysFldrs.inboxFid),l=new n.vm.ContainerSelector({containerList:u,filterFn:a});f=new i({alias:o.manifest.alias,newFolder:o.manifest.suggestedFolder,existingFolder:s,folderPickerViewmodel:l,suggestDefaultFrom:o.manifest.suggestDefaultFrom}),e=wLive.Controls.Notifications.createModalDialog({title:n.GetString("AliasRenameFlow.Alias.Header"),content:"<div id='AliasCreateRuleDialog'>"+h().render(f,r())+"<\/div>",buttons:{action:n.GetString("AliasRenameFlow.ConfirmButton"),alternate:n.GetString("AliasRenameFlow.CancelButton")},options:{dismissOnButtonClick:!1}});t(e).on("buttonclick",c);wLive.Controls.Notifications.getQueue().start()},o.showNotification=function(){e.show(),t("#AliasCreateRuleDialog").link(h(),f,r());var n=e.getButton({buttonName:"alternate"});f.suggestDefaultFrom()&&(n.toggle(!f.defaultFrom()),t.observable.simpleOn(f,"propertyChange",function(t,i){i.path==="DefaultFrom"&&n.toggle(!i.value)}))}},u="aliasCreateRuleDialogTmpl",e=t.templates(null,{markup:"#"+u,converters:{boolToStr:function(n){return n?"true":"false"},strToBool:function(n){return n==="true"},cssClassHideDefaultFrom:function(n,t,i){return n+(t&&i?" hidden":"")}}}),o={attr:"html",templateId:u,template:e,_custFolderCount:0,init:function(n){this.data=n.props.data},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var n=this,t=n.contents();t.on("click",".folderPicker",function(n){n.stopPropagation(),n.preventDefault()});t.find(".folderPickerLink").on("click",function(t){n._getFolderPicker().show(t.originalEvent,t.currentTarget),n.data.useNewFolder(!1)});t.find(".newFolderName").on("focus",function(){n.data.useNewFolder(!0)})},onCmdBubble:function(n,i,r){var f;if(i.name==="cp.menu.click"){var e=r.$event,o=t(e.target),u=null;return(u=o.closest(".cp_list .menuLinkItem").get(0))&&(f=t(u).view().data,this.data.existingFolder(f)),this._getFolderPicker().hide(),!1}},getBody:function(){return n.GetString("AliasRenameFlow.Alias.Body").format(this.data.alias())},getRuleText:function(){return n.GetString("AliasRenameFlow.Alias.CreateRuleText").format(this.data.alias())},maxFolderNameLength:function(){return n.GetAppConfig("maxCustomFolderNameLength")},hasCustomFolders:function(){var n=this.data.getCustomFolderCount();return n>0},canCreateFolders:function(){var t=this.data.getCustomFolderCount();return t<n.GetAppConfig("maximumCustomFolderCount")},_getFolderPicker:function(){return n.findChildTag(this,"containerPickerControl")[0]}},i;t.views.tags({aliasCreateRuleDialog:o}),i=function(t){function u(){i.useNewFolder()&&(!i.newFolder()||i.getCustomFolderCount()>=n.GetAppConfig("maximumCustomFolderCount"))&&i.useNewFolder(!1),i.suggestDefaultFrom()||i.defaultFrom(!1)}var i=this,r;i.initAccessorValues(t),r=null,i.getCustomFolderCount=function(){return r===null&&(r=i.folderPickerViewmodel().containerList().getCustomFolderCount()),r},u()},n.AddOptionsAccessorAndInitFunctions(i.prototype,s)}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var t=ol.inboxFlow=ol.inboxFlow||{},i=ol.inboxFlow.PopDeleteManager=function(t){var i=this;i.manifest=t,i.initializeNotification=n.noop,i.showNotification=function(){var t,i,n,r="<a href='/mail/PopEnableDisableSettings.aspx?n={0}'>{1}<\/a>",u;this.manifest.requestedFolderIsPop?(t=ol.GetString("RespectPopDeleteSettings.Pop.Superbar.Title"),n=r.format(ol.DynamicNonce(),ol.GetString("RespectPopDeleteSettings.Pop.Superbar.LinkText")),i=ol.GetString("RespectPopDeleteSettings.Pop.Superbar.Description").format(n)):(t=ol.GetString("RespectPopDeleteSettings.Inbox.Superbar.Title").format(this.manifest.popFolderName),n=r.format(ol.DynamicNonce(),ol.GetString("RespectPopDeleteSettings.Inbox.Superbar.LinkText")),i=ol.GetString("RespectPopDeleteSettings.Inbox.Superbar.Description").format(this.manifest.popFolderName,n)),u="<h3 class='Title'>{0}<\/h3><span class='Text'>{1}<\/span>".format(t,i),wLive.Controls.Notifications.createBottomBar({content:u,dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Explicit,buttons:{close:ol.GetString("Superbar.CloseButton.AltText")},options:{moreCss:"SuperBar WithTitle"}}).show()}}}(window.originaljQuery||window.jQuery),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("createrecipientmoverule",{fppMethod:"CreateRecipientMoveRule",tokenConfig:{friendlyName:"CreateRecipientMoveRule",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"recipientEmail",type:String},{name:"folderId",type:String},{name:"folderName",type:String}],suppressServerErrors:!0,returnServerResults:!0})}(),function(n,t){"use strict";var i=n.inboxFlow=n.inboxFlow||{},r=i.aliasCreationUpsellManager=function(i,r){function h(){var i=wLive.Controls.Notifications,e=t.templates("#"+s),r=e.render({},{ol:n,sutra:n.getSutra});r&&(u=i.createBottomBar({content:r,dismissalMode:i.BarDismissalMode.Explicit,buttons:{action:n.GetString("Easi.AliasUpsellSuperbar.ButtonStart"),close:n.GetString("Easi.AliasUpsellSuperbar.ButtonClose")},options:{moreCss:"SuperBar WithTitle sb_ni"}}),t(u).bind({beforeshow:function(){n.Cmd("log.aliasupsell").fire({UpsellType:HM.UpsellType.AliasSuperbar,UpsellEvent:HM.UpsellEvent.Show,UpsellDomain:f})}}))}function c(){var i=o;u&&u.show().then(function(r){if(t(u).unbind("beforeshow"),r.buttonClicked==="action")return n.Cmd("log.aliasupsell").fire({UpsellType:HM.UpsellType.AliasSuperbar,UpsellEvent:HM.UpsellEvent.ExitNext,UpsellDomain:f}),window.location.href=i,!1;if(r.buttonClicked==="close"){n.Cmd("log.aliasupsell").fire({UpsellType:HM.UpsellType.AliasSuperbar,UpsellEvent:HM.UpsellEvent.ExitDismiss,UpsellDomain:f});var e=n.Dispatcher.fireCmd("dismissaliasupsellsuperbar",{});return!1}})}var e=i,o=r.aliasCreateLink,f=r.userDomain,u,s="aliasCreationSuperbarContentTemplate";this.initializeNotification=function(){e==HM.InboxFlowID.AliasCreationSuperbar&&h()},this.showNotification=function(){if(e===HM.InboxFlowID.AliasCreationSuperbar)c();else throw new Error("Unsupported inbox flow ID");}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=window;i.wLive=i.wLive||{};var r=i.wLive,u=r.Controls.Notifications,f=n.inboxFlow=n.inboxFlow||{},e=f.importProgressIndicatorManager=function(r,f){function et(i){n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.StatusPopup,SwSelectInfo:HM.SwitchSelectInfo.Stop}),e.hideStatusMenu(!0),e.showStopFlyout(s.SwitchJobEmailAddress,t("."+b)[0]),i.preventDefault()}function d(t){var i="";switch(t){case HM.SwitchTaskStatus.NotStarted:i=n.GetString("Options.ImportAccount.Progress.StatusPreparing");break;case HM.SwitchTaskStatus.Completed:i=n.GetString("Options.ImportAccount.Progress.StatusDone");break;case HM.SwitchTaskStatus.StoppedByService:case HM.SwitchTaskStatus.StoppedByUser:i=n.GetString("Options.ImportAccount.Progress.StatusStopping")}return i}function ot(t){var u="",i={},r,f;if(i.menuItemId=g,i.menuItemSutra=n.getSutra("EmailImportStatusItem"),i.jobTaskType=n.GetString("Options.ImportAccount.Progress.PropertyEmail"),t.MailImportStatus==HM.SwitchTaskStatus.InProgress)if(r=t.SwitchMailImportCurrentCount,f=t.SwitchMailImportTotalCount,r===0||r===-1||f===-1)u=n.GetString("Options.ImportAccount.Progress.StatusPreparing");else if(r>0&&f>0)u=n.GetString("Options.ImportAccount.Progress.ResultFormat").format(r,f);else throw new Error(0,"Unexpected mail count.");else u=d(t.MailImportStatus);return i.statusText=u,i}function st(t){var r="",i={};return i.menuItemId=nt,i.menuItemSutra=n.getSutra("ContactsImportStatusItem"),i.jobTaskType=n.GetString("Options.ImportAccount.Progress.PropertyContact"),r=t.ContactSyncStatus==HM.SwitchTaskStatus.InProgress?n.GetString("Options.ImportAccount.Progress.StatusConnecting"):d(t.ContactSyncStatus),i.statusText=r,i}function ht(n){var t=[];return(n.SwitchJobType&HM.SwitchTaskType.Mail)>0&&t.push(ot(n)),(n.SwitchJobType&HM.SwitchTaskType.Contact)>0&&t.push(st(n)),t}function w(i){var r=t.templates("#"+rt);return r.render({propertyStatuses:ht(i)},n.getContextObject())}function ct(n){var i=(n.SwitchJobType&HM.SwitchTaskType.Contact)>0?99:100,r=(n.SwitchJobType&HM.SwitchTaskType.Mail)>0?1:100,t=0;if(n.MailImportStatus==HM.SwitchTaskStatus.InProgress||n.MailImportStatus==HM.SwitchTaskStatus.Completed)try{n.SwitchMailImportTotalCount>0&&(t=Math.floor(n.SwitchMailImportCurrentCount*i/n.SwitchMailImportTotalCount))}catch(u){}return n.ContactSyncStatus==HM.SwitchTaskStatus.Completed&&(t+=r),t}function lt(n){return n.MailImportStatus==HM.SwitchTaskStatus.InProgress||n.ContactSyncStatus==HM.SwitchTaskStatus.InProgress||n.SwitchUserAction==HM.SwitchUserAction.Starting&&(n.SwitchJobType&HM.SwitchTaskType.Mail)>0&&n.MailImportStatus==HM.SwitchTaskStatus.NotStarted||(n.SwitchJobType&HM.SwitchTaskType.Contact)>0&&n.ContactSyncStatus==HM.SwitchTaskStatus.NotStarted}function at(i){if(i.IsImportStatusEnabled===!1&&(y=!1),y){if(i&&lt(i)){if(s=i,i.SwitchUserAction!=HM.SwitchUserAction.Stopping){var r=n.GetString("Options.ImportAccount.Progress.StatusImporting").format(ct(i));e.showIndicator(r),h&&t("#"+p).html(w(i))}else h&&e.hideStatusMenu(!1),e.showIndicator(n.GetString("Options.ImportAccount.Progress.StatusStopping"));return!0}$Cookie.getCookie(k,!0)!=null&&$Cookie.deleteCookie(k,n.config.cookies.cookieDomain)}return s=null,e.hideIndicator(),!1}this.initializeNotification=function(){},this.showNotification=function(){e.getAndUpdateImportProgress(),r.StartRefreshTimer&&e.startRefreshTimer()};var e=this,y=!0,pt=typeof f=="undefined"?!0:f,a=!1,h=!1,v=!1,s=null,b="c_hicons",p="ISPropertyStatus",g="ISEmailStatus",nt="ISContactStatus",tt="_indicatorTmpl",it="_statusMenuTmpl",rt="_propertyStatusListTmpl",ut="_stopFlyoutTmpl",wt=r,k=r.ImportIsRunningCookie,ft=r.RefreshInterval,c=null,o=null,l=null;e.timerId=null,e.isIndicatorActive=!0,e.startRefreshTimer=function(){e.isIndicatorActive&&e.timerId==null&&(e.timerId=setInterval(t.proxy(e.getAndUpdateImportProgress,e),ft*1e3))},n.Cmd("nav.compose").subscribe(t.proxy(e.startRefreshTimer,e)),n.Cmd("nav.managecategories").subscribe(t.proxy(e.startRefreshTimer,e)),n.Cmd("nav.options").subscribe(t.proxy(e.startRefreshTimer,e)),e.stopRefreshTimer=function(){e.timerId!=null&&(clearInterval(e.timerId),e.timerId=null)},n.Cmd("nav.inbox").subscribe(t.proxy(e.stopRefreshTimer,e)),t(window).unload(t.proxy(e.stopRefreshTimer,e)),e.getAndUpdateImportProgress=function(){if(!e.isIndicatorActive)return!1;var t=n.Dispatcher.fireCmd("hbigetswitchstatus",{});t.deferred.then(function(n,t){if(t==null||t.length!==1)throw new Error(0,"Invalid server result at HbiGetSwitchStatus request.");var i=t[0];at(i)||(e.isIndicatorActive=!1,e.stopRefreshTimer())},function(){})},e.showIndicator=function(i){var r,u;if(i){if(a)t("#ImportProgressText").html(i);else if(r=t("."+b),r){r.show();var f=t.templates("#"+tt),o={statusText:i},c=t(f.render(o,n.getContextObject()));c.prependTo(r),t("#ImportProgressLink").bind("click",t.proxy(e.onIndicatorClick,e)),u=parseInt(t("#c_hiconm").attr("tabindex")),u&&t("#ImportProgressLink").attr("tabindex",u),a=!0}else y=!1;(s==null||s.SwitchUserAction==HM.SwitchUserAction.Stopping)&&(t("#ImportProgressLink").unbind("click"),t("#ImportProgressLink").bind("click",function(n){return n.preventDefault(),!1}),t("#ImportProgressLink").css("background-color","transparent").css("cursor","default"),h&&e.hideStatusMenu(!1))}},e.hideIndicator=function(){return a&&(h&&(e.hideStatusMenu(!1),c.unbind(),c.find("DIV.cm_list").unbind()),t("#ImportProgressLink").unbind("click"),t("#ImportProgress").remove(),a=!1),!1},e.onIndicatorClick=function(n){v||(h?e.hideStatusMenu(!1):e.showStatusMenu(n),n.preventDefault())},e.onMenuStateChange=function(){h&&o&&!o.isOpen()&&e.hideStatusMenu(!1)},e.showStatusMenu=function(r){var f=HM.SwitchState.Inbox,l;if(n.config.pageManager.manifests.ImportAccount!=null&&n.pages.pageManager.getCurrentView()===n.config.pageManager.manifests.ImportAccount.name&&(f=HM.SwitchState.ImportTop),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:f,SwSelectInfo:HM.SwitchSelectInfo.StatusDropdown}),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.StatusPopup}),c)t("#"+p).html(w(s));else{var a=t.templates("#"+it),v={stopButtonLabel:n.GetString("Options.ImportAccount.Progress.StopButton.LabelFormat").format(s.SwitchJobEmailAddress)},y=a.render(v,n.getContextObject()),u=t(y);t(u.find("#"+p).get(0)).html(w(s)),u.appendTo("#ImportProgress"),u.delegate("#ImportStop","click",et),u.delegate("UL.cm_menu","mousedown",!1),c=u.find("UL.cm_menu")}if(l=t.extend({},{},{noDockCache:!0,menuEl:c.get(0),eventType:"click",sourceRelativeToBody:!0,sourceEl:t("#ImportProgressLink").get(0)}),o&&(o.dispose(),o=null),i.$menu.create(r,0,l),o=t("#ImportProgressLink").get(0).menu,o)o.addStateListener(t.proxy(e.onMenuStateChange,e));else throw new Error(0,"Failed binding to menu.");return h=!0,!1},e.hideStatusMenu=function(i){if(v&&e.hideStopFlyout(),h)if(o!=null)n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.StatusPopup,SwExitInfo:i?HM.SwitchExitInfo.StopConfirmation:HM.SwitchExitInfo.NotApplicable}),t("#ImportStop").get(0).blur(),h=!1,o.hide(),o.dispose(),o=null,t("#ImportProgressLink").get(0).blur();else throw new Error(0,"Failed binding to menu.");else throw new Error(0,"Menu is not shown.");},e.showStopFlyout=function(i,r){var f={accountText:n.GetString("Options.ImportAccount.Progress.StopFlyoutAccountText").format(i)},o=t.templates("#"+ut),s=o.render(f,n.getContextObject());l=u.createFlyout({content:s,anchor:r,buttons:{action:n.GetString("Options.ImportAccount.Progress.StopFlyoutButton")}}),t(l).bind({aftershow:function(){v=!0}}),l.show().then(function(r){return t(l).unbind("aftershow"),v=!1,r.buttonClicked&&(n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Select,SwState:HM.SwitchState.StopPopup,SwSelectInfo:HM.SwitchSelectInfo.Stop}),e.stopSwitchJob(i)),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Exit,SwState:HM.SwitchState.StopPopup}),n.ImportAccountInstrumentationHelper.maybeLogEnterImportTopAction(),!1}),n.ImportAccountInstrumentationHelper.logSwitchEvent({SwEvent:HM.SwitchEvent.Enter,SwState:HM.SwitchState.StopPopup})},e.hideStopFlyout=function(){l.dismiss()},e.stopSwitchJob=function(i){var r=t("<div><\/div>");r.appendTo("#ImportProgress"),n.SHbiFppLoader.loadFppRequest(r,"shbistopswitchjobrequest",{emailAddress:i},6e4).then(function(t,i){var r,u;if(i==null||i.length==0)throw new Error(0,"Invalid server result at SwitchStopJob request.");for(r=0;r<i.length;r++)if(u=i[r],u&&u.type===HM.DLReturnType.SuccessBoolean){u.success?(s=null,e.showIndicator(n.GetString("Options.ImportAccount.Progress.StatusStopping"))):e.getAndUpdateImportProgress();return}throw new Error(0,"Invalid server result at SwitchStopJob request.");},function(n,t){var u=!1,r,i,f;if(t!=null&&t.length>0)for(r=0;r<t.length;r++)if(i=t[r],i&&(i.type===HM.DLReturnType.FppError||i.type===HM.DLReturnType.FppErrorUi)&&(f=parseInt(i.type===HM.DLReturnType.FppError?i.fppError.Error.ErrorCode:i.fppError.Error.errorCode,16),f===HM.MailErrorExport.ImportAccount_InvalidStatus)){e.getAndUpdateImportProgress(),u=!0;break}u||(s=null,e.hideIndicator())})}}}(window.ol,window.originaljQuery||window.jQuery)